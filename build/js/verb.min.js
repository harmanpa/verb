/*! verb 2020-12-22 */

!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).verb=e()}(function(){var i=this,e=(new Function("try {return this===window;}catch(e){ return false;}"),new Function("try {return this===global;}catch(e){return false;}")),t=new Function("try {return typeof importScripts === 'function';}catch(e){return false;}");return(e()||t())&&t()&&(onmessage=function(e){if(e.data.className&&e.data.methodName){var t,n,r,n=(t=e.data.className,n=e.data.methodName,r=i,t.split(".").forEach(function(e){r=r&&r[e]}),r?r[n]:null);if(!n)return console.error("could not find "+e.data.className+"."+e.data.methodName);postMessage({result:n.apply(null,e.data.args),id:e.data.id})}}),function(e,r){"use strict";function t(){return B.__string_rec(this,"")}e.eval=e.eval||{},e.core=e.core||{},e.geom=e.geom||{};var n={},P=P||{};function i(e,t){var n,r=Object.create(e);for(n in t)r[n]=t[n];return t.toString!==Object.prototype.toString&&(r.toString=t.toString),r}function C(){}function w(){}function k(){}function x(){}function o(){this.b=""}function M(){}(n.HxOverrides=C).__name__="HxOverrides",C.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:t=e.split("-");return new Date(t[0],t[1]-1,t[2],0,0,0);case 19:n=(t=e.split(" "))[0].split("-"),t=t[1].split(":");return new Date(n[0],n[1]-1,n[2],t[0],t[1],t[2]);default:throw U.thrown("Invalid date format : "+e)}},C.cca=function(e,t){t=e.charCodeAt(t);if(t==t)return t},C.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},C.now=function(){return Date.now()},(n.Lambda=w).__name__="Lambda",w.fold=function(e,t,n){for(var r=xe(e);r.hasNext();)n=t(r.next(),n);return n},Math.__name__="Math",(n.Reflect=k).__name__="Reflect",k.field=function(e,t){try{return e[t]}catch(e){return null}},k.fields=function(e){var t=[];if(null!=e){var n,r=Object.prototype.hasOwnProperty;for(n in e)"__id__"!=n&&"hx__closures__"!=n&&r.call(e,n)&&t.push(n)}return t},k.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},k.deleteField=function(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)},(n.Std=x).__name__="Std",x.string=function(e){return B.__string_rec(e,"")},(n.StringBuf=o).__name__="StringBuf",o.prototype={__class__:o};var s=P.ValueType={__ename__:"ValueType",__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"],TNull:{_hx_index:0,__enum__:"ValueType",toString:t},TInt:{_hx_index:1,__enum__:"ValueType",toString:t},TFloat:{_hx_index:2,__enum__:"ValueType",toString:t},TBool:{_hx_index:3,__enum__:"ValueType",toString:t},TObject:{_hx_index:4,__enum__:"ValueType",toString:t},TFunction:{_hx_index:5,__enum__:"ValueType",toString:t},TClass:((d=function(e){return{_hx_index:6,c:e,__enum__:"ValueType",toString:t}}).__params__=["c"],d),TEnum:((d=function(e){return{_hx_index:7,e:e,__enum__:"ValueType",toString:t}}).__params__=["e"],d),TUnknown:{_hx_index:8,__enum__:"ValueType",toString:t}};(n.Type=M).__name__="Type",M.createEnum=function(e,t,n){var r=k.field(e,t);if(null==r)throw U.thrown("No such constructor "+t);if(k.isFunction(r)){if(null==n)throw U.thrown("Constructor "+t+" need parameters");return r.apply(e,n)}if(null!=n&&0!=n.length)throw U.thrown("Constructor "+t+" does not need parameters");return r},M.typeof=function(e){switch(typeof e){case"boolean":return s.TBool;case"function":return e.__name__||e.__ename__?s.TObject:s.TFunction;case"number":return Math.ceil(e)==e%2147483648?s.TInt:s.TFloat;case"object":if(null==e)return s.TNull;var t=e.__enum__;if(null!=t)return s.TEnum(P[t]);t=B.getClass(e);return null!=t?s.TClass(t):s.TObject;case"string":return s.TClass(String);case"undefined":return s.TNull;default:return s.TUnknown}},M.enumParameters=function(e){var t=P[e.__enum__],n=t[t.__constructs__[e._hx_index]].__params__;if(null==n)return[];for(var r=[],i=0;i<n.length;){var o=n[i];++i,r.push(e[o])}return r};var a=function(){};(n["haxe.IMap"]=a).__name__="haxe.IMap",a.__isInterface__=!0;var U=function(e,t,n){Error.call(this,e),this.message=e,this.__previousException=t,this.__nativeException=null!=n?n:this};(n["haxe.Exception"]=U).__name__="haxe.Exception",U.thrown=function(e){return e instanceof U?e.get_native():e instanceof Error?e:new l(e)},U.__super__=Error,U.prototype=i(Error.prototype,{get_native:function(){return this.__nativeException},__class__:U});var z=function(){this.buf=new o,this.cache=[],this.useCache=z.USE_CACHE,this.useEnumIndex=z.USE_ENUM_INDEX,this.shash=new V,this.scount=0};function u(){}(n["haxe.Serializer"]=z).__name__="haxe.Serializer",z.prototype={toString:function(){return this.buf.b},serializeString:function(e){var t=this.shash.h[e];if(null!=t)return this.buf.b+="R",void(this.buf.b+=null==t?"null":""+t);this.shash.h[e]=this.scount++,this.buf.b+="y",e=encodeURIComponent(e),this.buf.b+=x.string(e.length),this.buf.b+=":",this.buf.b+=null==e?"null":""+e},serializeRef:function(e){for(var t=typeof e,n=0,r=this.cache.length;n<r;){var i=n++,o=this.cache[i];if(typeof o==t&&o==e)return this.buf.b+="r",this.buf.b+=null==i?"null":""+i,!0}return this.cache.push(e),!1},serializeFields:function(e){for(var t=0,n=k.fields(e);t<n.length;){var r=n[t];++t,this.serializeString(r),this.serialize(k.field(e,r))}this.buf.b+="g"},serialize:function(e){switch((S=M.typeof(e))._hx_index){case 0:this.buf.b+="n";break;case 1:if(0==(t=e))return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==t?"null":""+t;break;case 2:var t=e;isNaN(t)?this.buf.b+="k":isFinite(t)?(this.buf.b+="d",this.buf.b+=null==t?"null":""+t):this.buf.b+=t<0?"m":"p";break;case 3:this.buf.b+=e?"t":"f";break;case 4:if(B.__instanceof(e,Ne)){var n=e.__name__;this.buf.b+="A",this.serializeString(n)}else if(B.__instanceof(e,Ee))this.buf.b+="B",this.serializeString(e.__ename__);else{if(this.useCache&&this.serializeRef(e))return;this.buf.b+="o",this.serializeFields(e)}break;case 5:throw U.thrown("Cannot serialize function");case 6:var r=S.c;if(r==String)return void this.serializeString(e);if(this.useCache&&this.serializeRef(e))return;switch(r){case Array:var i=0;this.buf.b+="a";for(var o=0,s=e.length;o<s;)null==e[f=o++]?++i:(0<i&&(1==i?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==i?"null":""+i),i=0),this.serialize(e[f]));0<i&&(1==i?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==i?"null":""+i)),this.buf.b+="h";break;case Date:var a=e;this.buf.b+="v",this.buf.b+=x.string(a.getTime());break;case I:this.buf.b+="q";for(var u=(t=e).keys();u.hasNext();){var l=u.next();this.buf.b+=":",this.buf.b+=null==l?"null":""+l,this.serialize(t.h[l])}this.buf.b+="h";break;case N:this.buf.b+="l";for(var h=(t=e).h;null!=h;){var c=h.item,h=h.next,f=c;this.serialize(f)}this.buf.b+="h";break;case E:this.buf.b+="M";for(u=(t=e).keys();u.hasNext();){var l=u.next(),v=k.field(l,"__id__");k.deleteField(l,"__id__"),this.serialize(l),l.__id__=v,this.serialize(t.h[l.__id__])}this.buf.b+="h";break;case V:this.buf.b+="b";for(t=e,u=V.keysIterator(t.h);u.hasNext();){l=u.next();this.serializeString(l),this.serialize(t.h[l])}this.buf.b+="h";break;case T:t=e;this.buf.b+="s",this.buf.b+=x.string(Math.ceil(8*t.length/6)),this.buf.b+=":";var f=0,_=t.length-2;if(null==(d=z.BASE64_CODES)){for(var d=new Array(z.BASE64.length),o=0,s=z.BASE64.length;o<s;){var g=o++;d[g]=C.cca(z.BASE64,g)}z.BASE64_CODES=d}for(;f<_;){var p=t.b[f++],m=t.b[f++],b=t.b[f++];this.buf.b+=String.fromCodePoint(d[p>>2]),this.buf.b+=String.fromCodePoint(d[63&(p<<4|m>>4)]),this.buf.b+=String.fromCodePoint(d[63&(m<<2|b>>6)]),this.buf.b+=String.fromCodePoint(d[63&b])}f==_?(p=t.b[f++],m=t.b[f++],this.buf.b+=String.fromCodePoint(d[p>>2]),this.buf.b+=String.fromCodePoint(d[63&(p<<4|m>>4)]),this.buf.b+=String.fromCodePoint(d[m<<2&63])):f==1+_&&(p=t.b[f++],this.buf.b+=String.fromCodePoint(d[p>>2]),this.buf.b+=String.fromCodePoint(d[p<<4&63]));break;default:this.useCache&&this.cache.pop(),null!=e.hxSerialize?(this.buf.b+="C",this.serializeString(r.__name__),this.useCache&&this.cache.push(e),e.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(r.__name__),this.useCache&&this.cache.push(e),this.serializeFields(e))}break;case 7:n=S.e;if(this.useCache){if(this.serializeRef(e))return;this.cache.pop()}this.buf.b+=x.string(this.useEnumIndex?"j":"w"),this.serializeString(n.__ename__),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=x.string(e._hx_index)):(n=e,this.serializeString(P[n.__enum__].__constructs__[n._hx_index])),this.buf.b+=":";var w=M.enumParameters(e);this.buf.b+=x.string(w.length);for(var S=0;S<w.length;){var y=w[S];++S,this.serialize(y)}this.useCache&&this.cache.push(e);break;default:throw U.thrown("Cannot serialize "+x.string(e))}},__class__:z},(n["haxe._Unserializer.DefaultResolver"]=u).__name__="haxe._Unserializer.DefaultResolver",u.prototype={resolveClass:function(e){return n[e]},resolveEnum:function(e){return P[e]},__class__:u};var A=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];e=A.DEFAULT_RESOLVER;null==e&&(e=new u,A.DEFAULT_RESOLVER=e),this.resolver=e};(n["haxe.Unserializer"]=A).__name__="haxe.Unserializer",A.initCodes=function(){for(var e=[],t=0,n=A.BASE64.length;t<n;){var r=t++;e[A.BASE64.charCodeAt(r)]=r}return e},A.prototype={readDigits:function(){for(var e=0,t=!1,n=this.pos;;){var r=this.buf.charCodeAt(this.pos);if(r!=r)break;if(45!=r){if(r<48||57<r)break;e=10*e+(r-48),this.pos++}else{if(this.pos!=n)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(43<=t&&t<58||101==t||69==t))break;this.pos++}return parseFloat(C.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw U.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw U.thrown("Invalid object key");var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw U.thrown("Invalid enum format");var n=this.readDigits();if(0==n)return M.createEnum(e,t);for(var r=[];0<n--;)r.push(this.unserialize());return M.createEnum(e,t,r)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize();if(null==(u=this.resolver.resolveClass(e)))throw U.thrown("Class not found "+e);return u;case 66:e=this.unserialize();if(null==(l=this.resolver.resolveEnum(e)))throw U.thrown("Enum not found "+e);return l;case 67:e=this.unserialize();if(null==(u=this.resolver.resolveClass(e)))throw U.thrown("Class not found "+e);var t=Object.create(u.prototype);if(this.cache.push(t),t.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw U.thrown("Invalid custom data");return t;case 77:var n=new E;this.cache.push(n);for(var r=this.buf;104!=this.buf.charCodeAt(this.pos);){var i=this.unserialize();n.set(i,this.unserialize())}return this.pos++,n;case 82:if((v=this.readDigits())<0||v>=this.scache.length)throw U.thrown("Invalid string reference");return this.scache[v];case 97:var r=this.buf,o=[];for(this.cache.push(o);;){if(104==(c=this.buf.charCodeAt(this.pos))){this.pos++;break}117==c?(this.pos++,v=this.readDigits(),o[o.length+v-1]=null):o.push(this.unserialize())}return o;case 98:n=new V;this.cache.push(n);for(r=this.buf;104!=this.buf.charCodeAt(this.pos);){var i=this.unserialize(),s=this.unserialize();n.h[i]=s}return this.pos++,n;case 99:e=this.unserialize();if(null==(u=this.resolver.resolveClass(e)))throw U.thrown("Class not found "+e);t=Object.create(u.prototype);return this.cache.push(t),this.unserializeObject(t),t;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:e=this.unserialize();if(null==(k=this.resolver.resolveEnum(e)))throw U.thrown("Enum not found "+e);this.pos++;var a=this.readDigits(),u=k.__constructs__.slice()[a];if(null==u)throw U.thrown("Unknown enum index "+e+"@"+a);var l=this.unserializeEnum(k,u);return this.cache.push(l),l;case 107:return NaN;case 108:var h=new N;this.cache.push(h);for(r=this.buf;104!=this.buf.charCodeAt(this.pos);)h.add(this.unserialize());return this.pos++,h;case 109:return-1/0;case 110:return null;case 111:t={};return this.cache.push(t),this.unserializeObject(t),t;case 112:return 1/0;case 113:n=new I;this.cache.push(n);for(var r=this.buf,c=this.buf.charCodeAt(this.pos++);58==c;){var f=this.readDigits(),s=this.unserialize();n.h[f]=s,c=this.buf.charCodeAt(this.pos++)}if(104!=c)throw U.thrown("Invalid IntMap format");return n;case 114:var v;if((v=this.readDigits())<0||v>=this.cache.length)throw U.thrown("Invalid reference");return this.cache[v];case 115:var _=this.readDigits(),r=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<_)throw U.thrown("Invalid bytes length");var d=A.CODES;null==d&&(d=A.initCodes(),A.CODES=d);for(var t=3&_,g=(f=this.pos)+(_-t),p=new T(new ArrayBuffer(3*(_>>2)+(2<=t?t-1:0))),m=0;f<g;){var b=d[r.charCodeAt(f++)],w=d[r.charCodeAt(f++)];p.b[m++]=b<<2|w>>4;var S=d[r.charCodeAt(f++)];p.b[m++]=w<<4|S>>2;var y=d[r.charCodeAt(f++)];p.b[m++]=S<<6|y}return 2<=t&&(b=d[r.charCodeAt(f++)],w=d[r.charCodeAt(f++)],p.b[m++]=b<<2|w>>4,3==t&&(S=d[r.charCodeAt(f++)],p.b[m++]=w<<4|S>>2)),this.pos+=_,this.cache.push(p),p;case 116:return!0;case 118:var P;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(P=C.strDate(C.substr(this.buf,this.pos,19)),this.pos+=19):P=new Date(this.readFloat()),this.cache.push(P),P;case 119:var k,e=this.unserialize();if(null==(k=this.resolver.resolveEnum(e)))throw U.thrown("Enum not found "+e);l=this.unserializeEnum(k,this.unserialize());return this.cache.push(l),l;case 120:throw U.thrown(this.unserialize());case 121:_=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<_)throw U.thrown("Invalid string length");i=C.substr(this.buf,this.pos,_);return this.pos+=_,i=decodeURIComponent(i.split("+").join(" ")),this.scache.push(i),i;case 122:return 0}throw this.pos--,U.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:A};var l=function(e,t,n){U.call(this,String(e),t,n),this.value=e};(n["haxe.ValueException"]=l).__name__="haxe.ValueException",l.__super__=U,l.prototype=i(U.prototype,{__class__:l});var I=function(){this.h={}};(n["haxe.ds.IntMap"]=I).__name__="haxe.ds.IntMap",I.__interfaces__=[a],I.prototype={keys:function(){var e,t=[];for(e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return new c(t)},__class__:I};var N=function(){this.length=0};(n["haxe.ds.List"]=N).__name__="haxe.ds.List",N.prototype={add:function(e){e=new h(e,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:N};var h=function(e,t){this.item=e,this.next=t};(n["haxe.ds._List.ListNode"]=h).__name__="haxe.ds._List.ListNode",h.prototype={__class__:h};var E=function(){this.h={__keys__:{}}};(n["haxe.ds.ObjectMap"]=E).__name__="haxe.ds.ObjectMap",E.__interfaces__=[a],E.prototype={set:function(e,t){var n=e.__id__;null==n&&(n=e.__id__=r.$haxeUID++),this.h[n]=t,this.h.__keys__[n]=e},keys:function(){var e,t=[];for(e in this.h.__keys__)this.h.hasOwnProperty(e)&&t.push(this.h.__keys__[e]);return new c(t)},__class__:E};var V=function(){this.h=Object.create(null)};(n["haxe.ds.StringMap"]=V).__name__="haxe.ds.StringMap",V.__interfaces__=[a],V.keysIterator=function(e){var t=Object.keys(e),n=t.length,r=0;return{hasNext:function(){return r<n},next:function(){return t[(r+=1)-1]}}},V.prototype={__class__:V};var T=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(n["haxe.io.Bytes"]=T).__name__="haxe.io.Bytes",T.prototype={__class__:T};var c=function(e){this.current=0,this.array=e};(n["haxe.iterators.ArrayIterator"]=c).__name__="haxe.iterators.ArrayIterator",c.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:c};var B=function(){};function f(){}function L(){}function de(){}(n["js.Boot"]=B).__name__="js.Boot",B.getClass=function(e){if(null==e)return null;if(e instanceof Array)return Array;var t=e.__class__;if(null!=t)return t;e=B.__nativeClassName(e);return null!=e?B.__resolveNativeClass(e):null},B.__string_rec=function(i,o){if(null==i)return"null";if(5<=o.length)return"<...>";var e,t=typeof i;switch("function"==t&&(i.__name__||i.__ename__)&&(t="object"),t){case"function":return"<function>";case"object":if(i.__enum__){var n=P[i.__enum__],r=n.__constructs__[i._hx_index],s=n[r];return s.__params__?(o+="\t",r+"("+function(){for(var e=[],t=0,n=s.__params__;t<n.length;){var r=n[t];t+=1,e.push(B.__string_rec(i[r],o))}return e}().join(",")+")"):r}if(i instanceof Array){var a="[";o+="\t";for(var u=0,l=i.length;u<l;){var h=u++;a+=(0<h?",":"")+B.__string_rec(i[h],o)}return a+="]"}try{e=i.toString}catch(u){return"???"}if(null!=e&&e!=Object.toString&&"function"==typeof e){r=i.toString();if("[object Object]"!=r)return r}a="{\n";o+="\t";var c=null!=i.hasOwnProperty,f=null;for(f in i)c&&!i.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=a.length&&(a+=", \n"),a+=o+f+" : "+B.__string_rec(i[f],o));return a+="\n"+(o=o.substring(1))+"}";case"string":return i;default:return String(i)}},B.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var r=0,i=n.length;r<i;){var o=n[r++];if(o==t||B.__interfLoop(o,t))return!0}return B.__interfLoop(e.__super__,t)},B.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array;case Ie:return"boolean"==typeof e;case ze:return null!=e;case Ae:return"number"==typeof e;case Me:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(B.__downcastCheck(e,t))return!0}else if("object"==typeof t&&B.__isNativeObj(t)&&e instanceof t)return!0;return t==Ne&&null!=e.__name__?!0:t==Ee&&null!=e.__ename__||null!=e.__enum__&&P[e.__enum__]==t}},B.__downcastCheck=function(e,t){return e instanceof t||!!t.__isInterface__&&B.__interfLoop(B.getClass(e),t)},B.__nativeClassName=function(e){e=B.__toStr.call(e).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},B.__isNativeObj=function(e){return null!=B.__nativeClassName(e)},B.__resolveNativeClass=function(e){return r[e]},(n["verb.Verb"]=f).__name__="verb.Verb",f.main=function(){console.log("src/verb/Verb.hx:45:","verb 2.1.0")},(n["verb.core.ArrayExtensions"]=L).__name__="verb.core.ArrayExtensions",L.alloc=function(e,t){if(!(t<0))for(;e.length<t;)e.push(null)},L.reversed=function(e){e=e.slice();return e.reverse(),e},L.last=function(e){return e[e.length-1]},L.first=function(e){return e[0]},L.spliceAndInsert=function(e,t,n,r){e.splice(t,n),e.splice(t,0,r)},L.left=function(e){if(0==e.length)return[];var t=Math.ceil(e.length/2);return e.slice(0,t)},L.right=function(e){if(0==e.length)return[];var t=Math.ceil(e.length/2);return e.slice(t)},L.rightWithPivot=function(e){if(0==e.length)return[];var t=Math.ceil(e.length/2);return e.slice(t-1)},L.unique=function(e,t){var n=[];if(0==e.length)return n;for(n.push(e.pop());0<e.length;){for(var r=e.pop(),i=!0,o=0;o<n.length;){var s=n[o];if(++o,t(r,s)){i=!1;break}}i&&n.push(r)}return n},(n["verb.core.Binomial"]=de).__name__="verb.core.Binomial",de.get=function(e,t){if(0==t)return 1;if(0==e||e<t)return 0;if(e-t<t&&(t=e-t),de.memo_exists(e,t))return de.get_memo(e,t);for(var n=1,r=e,i=1,o=t+1;i<o;){var s=i++;de.memo_exists(r,s)?(--e,n=de.get_memo(r,s)):(n*=e--,de.memoize(r,s,n/=s))}return n},de.get_no_memo=function(e,t){if(0==t)return 1;if(0==e||e<t)return 0;e-t<t&&(t=e-t);for(var n=1,r=1,i=t+1;r<i;)n*=e--,n/=r++;return n},de.memo_exists=function(e,t){return!!de.memo.h.hasOwnProperty(e)&&de.memo.h[e].h.hasOwnProperty(t)},de.get_memo=function(e,t){return de.memo.h[e].h[t]},de.memoize=function(e,t,n){var r,i;de.memo.h.hasOwnProperty(e)||(r=de.memo,i=new I,r.h[e]=i),de.memo.h[e].h[t]=n};var v=e.core.BoundingBox=function(e){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=e&&this.addRange(e)};(n["verb.core.BoundingBox"]=v).__name__="verb.core.BoundingBox",v.intervalsOverlap=function(e,t,n,r,i){null==i&&(i=-1);var o=i<-.5?D.TOLERANCE:i,i=Math.min(e,t)-o,e=Math.max(e,t)+o,t=Math.min(n,r)-o,o=Math.max(n,r)+o;return t<=i&&i<=o||t<=e&&e<=o||i<=t&&t<=e||i<=o&&o<=e},v.prototype={fromPoint:function(e){return new v([e])},add:function(e){if(!this.initialized)return this.dim=e.length,this.min=e.slice(0),this.max=e.slice(0),this.initialized=!0,this;for(var t=0,n=this.dim;t<n;){var r=t++;e[r]>this.max[r]&&(this.max[r]=e[r]),e[r]<this.min[r]&&(this.min[r]=e[r])}return this},addRange:function(e){for(var t=0,n=e.length;t<n;){var r=t++;this.add(e[r])}return this},contains:function(e,t){return null==t&&(t=-1),!!this.initialized&&this.intersects(new v([e]),t)},intersects:function(e,t){if(null==t&&(t=-1),!this.initialized||!e.initialized)return!1;for(var n=this.min,r=this.max,i=e.min,o=e.max,s=0,a=this.dim;s<a;){var u=s++;if(!v.intervalsOverlap(n[u],r[u],i[u],o[u],t))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var e=0,t=0,n=0,r=this.dim;n<r;){var i=n++,o=this.getAxisLength(i);e<o&&(e=o,t=i)}return t},getAxisLength:function(e){return e<0||e>this.dim-1?0:Math.abs(this.min[e]-this.max[e])},intersect:function(e,t){if(!this.initialized)return null;var n=this.min,r=this.max,i=e.min,o=e.max;if(!this.intersects(e,t))return null;for(var s=[],a=[],u=0,l=this.dim;u<l;){var h=u++;s.push(Math.min(r[h],o[h])),a.push(Math.max(n[h],i[h]))}return new v([a,s])},__class__:v};var D=e.core.Constants=function(){};(n["verb.core.Constants"]=D).__name__="verb.core.Constants";var _=e.core.SerializableBase=function(){};(n["verb.core.SerializableBase"]=_).__name__="verb.core.SerializableBase",_.prototype={serialize:function(){var e=new z;return e.serialize(this),e.toString()},__class__:_};var d=e.core.Plane=function(e,t){this.origin=e,this.normal=t};(n["verb.core.Plane"]=d).__name__="verb.core.Plane",d.__super__=_,d.prototype=i(_.prototype,{__class__:d});var g=e.core.Ray=function(e,t){this.origin=e,this.dir=t};(n["verb.core.Ray"]=g).__name__="verb.core.Ray",g.__super__=_,g.prototype=i(_.prototype,{__class__:g});var ge=e.core.NurbsCurveData=function(e,t,n){this.degree=e,this.controlPoints=n,this.knots=t};(n["verb.core.NurbsCurveData"]=ge).__name__="verb.core.NurbsCurveData",ge.__super__=_,ge.prototype=i(_.prototype,{__class__:ge});var O=e.core.NurbsSurfaceData=function(e,t,n,r,i){this.degreeU=e,this.degreeV=t,this.knotsU=n,this.knotsV=r,this.controlPoints=i};(n["verb.core.NurbsSurfaceData"]=O).__name__="verb.core.NurbsSurfaceData",O.__super__=_,O.prototype=i(_.prototype,{__class__:O});var y=e.core.MeshData=function(e,t,n,r){this.faces=e,this.points=t,this.normals=n,this.uvs=r};(n["verb.core.MeshData"]=y).__name__="verb.core.MeshData",y.empty=function(){return new y([],[],[],[])},y.__super__=_,y.prototype=i(_.prototype,{__class__:y}),a=e.core.PolylineData=function(e,t){this.points=e,this.params=t},(n["verb.core.PolylineData"]=a).__name__="verb.core.PolylineData",a.__super__=_,a.prototype=i(_.prototype,{__class__:a}),d=e.core.VolumeData=function(e,t,n,r,i,o,s){this.degreeU=e,this.degreeV=t,this.degreeW=n,this.knotsU=r,this.knotsV=i,this.knotsW=o,this.controlPoints=s},(n["verb.core.VolumeData"]=d).__name__="verb.core.VolumeData",d.__super__=_,d.prototype=i(_.prototype,{__class__:d});var p=e.core.Pair=function(e,t){this.item0=e,this.item1=t};(n["verb.core.Pair"]=p).__name__="verb.core.Pair",p.prototype={__class__:p};var S=e.core.Interval=function(e,t){this.min=e,this.max=t};(n["verb.core.Interval"]=S).__name__="verb.core.Interval",S.prototype={__class__:S};var m=e.core.CurveCurveIntersection=function(e,t,n,r){this.point0=e,this.point1=t,this.u0=n,this.u1=r};(n["verb.core.CurveCurveIntersection"]=m).__name__="verb.core.CurveCurveIntersection",m.prototype={__class__:m};var b=e.core.CurveSurfaceIntersection=function(e,t,n,r){this.u=e,this.uv=t,this.curvePoint=n,this.surfacePoint=r};(n["verb.core.CurveSurfaceIntersection"]=b).__name__="verb.core.CurveSurfaceIntersection",b.prototype={__class__:b};var R=e.core.MeshIntersectionPoint=function(e,t,n,r,i){this.visited=!1,this.adj=null,this.opp=null,this.uv0=e,this.uv1=t,this.point=n};(n["verb.core.MeshIntersectionPoint"]=R).__name__="verb.core.MeshIntersectionPoint",R.prototype={__class__:R};var F=e.core.PolylineMeshIntersection=function(e,t,n,r,i){this.point=e,this.u=t,this.uv=n,this.polylineIndex=r,this.faceIndex=i};(n["verb.core.PolylineMeshIntersection"]=F).__name__="verb.core.PolylineMeshIntersection",F.prototype={__class__:F};var j=e.core.SurfaceSurfaceIntersectionPoint=function(e,t,n,r){this.uv0=e,this.uv1=t,this.point=n,this.dist=r};(n["verb.core.SurfaceSurfaceIntersectionPoint"]=j).__name__="verb.core.SurfaceSurfaceIntersectionPoint",j.prototype={__class__:j};var G=e.core.TriSegmentIntersection=function(e,t,n,r){this.point=e,this.s=t,this.t=n,this.p=r};(n["verb.core.TriSegmentIntersection"]=G).__name__="verb.core.TriSegmentIntersection",G.prototype={__class__:G};var K=e.core.CurveTriPoint=function(e,t,n){this.u=e,this.point=t,this.uv=n};function q(e,t,n,r,i){null==i&&(i=!1),null==r&&(r=-1),this.uv=n,this.point=e,this.normal=t,this.id=r,this.degen=i}(n["verb.core.CurveTriPoint"]=K).__name__="verb.core.CurveTriPoint",K.prototype={__class__:K},(n["verb.core.SurfacePoint"]=q).__name__="verb.core.SurfacePoint",q.fromUv=function(e,t){return new q(null,null,[e,t])},q.prototype={__class__:q},a=e.core.CurvePoint=function(e,t){this.u=e,this.pt=t},(n["verb.core.CurvePoint"]=a).__name__="verb.core.CurvePoint",a.prototype={__class__:a};var W=e.core.KdTree=function(e,t){this.dim=3,this.points=e,this.distanceFunction=t,this.dim=e[0].point.length,this.root=this.buildTree(e,0,null)};(n["verb.core.KdTree"]=W).__name__="verb.core.KdTree",W.prototype={buildTree:function(e,t,n){var r=t%this.dim;if(0==e.length)return null;if(1==e.length)return new X(e[0],r,n);e.sort(function(e,t){t=e.point[r]-t.point[r];return 0==t?0:0<t?1:-1});var i=Math.floor(e.length/2),n=new X(e[i],r,n);return n.left=this.buildTree(e.slice(0,i),t+1,n),n.right=this.buildTree(e.slice(i+1),t+1,n),n},nearest:function(c,f,e){for(var v=this,_=new H(function(e){return-e.item1}),d=null,d=function(e){for(var t=e.dimension,n=v.distanceFunction(c,e.kdPoint.point),r=[],i=0,o=v.dim;i<o;){var s=i++;r.push(0)}for(var a,u=r,l=function(e,t){_.push(new p(e,t)),_.size()>f&&_.pop()},r=0,i=v.dim;r<i;)(s=r++)==e.dimension?u[s]=c[s]:u[s]=e.kdPoint.point[s];var h=v.distanceFunction(u,e.kdPoint.point);null!=e.right||null!=e.left?(t=null==e.right||null!=e.left&&c[t]<e.kdPoint.point[t]?e.left:e.right,d(t),(_.size()<f||n<_.peek().item1)&&l(e,n),(_.size()<f||Math.abs(h)<_.peek().item1)&&null!=(a=t==e.left?e.right:e.left)&&d(a)):(_.size()<f||n<_.peek().item1)&&l(e,n)},t=0,n=f;t<n;){var r=t++;_.push(new p(null,e))}d(this.root);for(var i=[],t=0,n=f;t<n;){r=t++;null!=_.content[r].item0&&i.push(new p(_.content[r].item0.kdPoint,_.content[r].item1))}return i},__class__:W};var H=function(e){this.content=[],this.scoreFunction=e};(n["verb.core.BinaryHeap"]=H).__name__="verb.core.BinaryHeap",H.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return 0<this.content.length&&(this.content[0]=t,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var t=this.content.length,n=0,r=t;n<r;){var i=n++;if(this.content[i]==e){var o=this.content.pop();return void(i!=t-1&&(this.content[i]=o,this.scoreFunction(o)<this.scoreFunction(e)?this.bubbleUp(i):this.sinkDown(i)))}}throw U.thrown("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];0<e;){var n=Math.floor((e+1)/2)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},sinkDown:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var i,o=2*(e+1),s=o-1,a=-1,u=0;if(s<t&&(i=this.content[s],(u=this.scoreFunction(i))<r&&(a=s)),o<t&&(s=this.content[o],this.scoreFunction(s)<(-1==a?r:u)&&(a=o)),-1==a)break;this.content[e]=this.content[a],this.content[a]=n,e=a}},__class__:H};var Z=e.core.KdPoint=function(e,t){this.point=e,this.obj=t};(n["verb.core.KdPoint"]=Z).__name__="verb.core.KdPoint",Z.prototype={__class__:Z};var X=e.core.KdNode=function(e,t,n){this.kdPoint=e,this.left=null,this.right=null,this.parent=n,this.dimension=t};function Y(e,t){this._boundingBox=null,this._curve=e,null==t&&(e=this._curve.knots,t=(L.last(e)-L.first(e))/64),this._knotTol=t}function J(e,t){if(this._boundingBox=null,this._mesh=e,null==t){for(var n=[],r=0,i=e.faces.length;r<i;){var o=r++;n.push(o)}t=n}this._faceIndices=t}function Q(e,t){this._boundingBox=null,this._polyline=e,null==t&&(t=new S(0,0!=e.points.length?e.points.length-1:0)),this._interval=t}function $(e,t,n,r){var i;null==t&&(t=!1),this._boundingBox=null,this._surface=e,this._splitV=t,null==n&&(i=e.knotsU,n=(L.last(i)-L.first(i))/16),null==r&&(i=e.knotsV,r=(L.last(i)-L.first(i))/16),this._knotTolU=n,this._knotTolV=r}(n["verb.core.KdNode"]=X).__name__="verb.core.KdNode",X.prototype={__class__:X},d=function(){},(n["verb.eval.IBoundingBoxTree"]=d).__name__="verb.eval.IBoundingBoxTree",d.__isInterface__=!0,d.prototype={__class__:d},(n["verb.core.LazyCurveBoundingBoxTree"]=Y).__name__="verb.core.LazyCurveBoundingBoxTree",Y.__interfaces__=[d],Y.prototype={split:function(){var e=L.first(this._curve.knots),t=L.last(this._curve.knots),n=t-e,n=he.curveSplit(this._curve,(t+e)/2+.1*n*Math.random());return new p(new Y(n[0],this._knotTol),new Y(n[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new v(fe.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},yield:function(){return this._curve},indivisible:function(e){var t=this._curve.knots;return L.last(t)-L.first(t)<this._knotTol},empty:function(){return!1},__class__:Y},(n["verb.core.LazyMeshBoundingBoxTree"]=J).__name__="verb.core.LazyMeshBoundingBoxTree",J.__interfaces__=[d],J.prototype={split:function(){var e=ne.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),t=L.left(e),e=L.right(e);return new p(new J(this._mesh,t),new J(this._mesh,e))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=ne.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},yield:function(){return this._faceIndices[0]},indivisible:function(e){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length},__class__:J},(n["verb.core.LazyPolylineBoundingBoxTree"]=Q).__name__="verb.core.LazyPolylineBoundingBoxTree",Q.__interfaces__=[d],Q.prototype={split:function(){var e=this._interval.min,t=this._interval.max,n=e+Math.ceil((t-e)/2),e=new S(e,n),t=new S(n,t);return new p(new Q(this._polyline,e),new Q(this._polyline,t))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new v(this._polyline.points)),this._boundingBox},yield:function(){return this._interval.min},indivisible:function(e){return this._interval.max-this._interval.min==1},empty:function(){return this._interval.max-this._interval.min==0},__class__:Q},(n["verb.core.LazySurfaceBoundingBoxTree"]=$).__name__="verb.core.LazySurfaceBoundingBoxTree",$.__interfaces__=[d],$.prototype={split:function(){var e,t=this._splitV?(e=L.first(this._surface.knotsV),L.last(this._surface.knotsV)):(e=L.first(this._surface.knotsU),L.last(this._surface.knotsU)),t=(e+t)/2,t=he.surfaceSplit(this._surface,t,this._splitV);return new p(new $(t[0],!this._splitV,this._knotTolU,this._knotTolV),new $(t[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new v;for(var e=0,t=this._surface.controlPoints;e<t.length;){var n=t[e];++e,this._boundingBox.addRange(fe.dehomogenize1d(n))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(e){var t=this._surface.knotsV;if(L.last(t)-L.first(t)<this._knotTolV){t=this._surface.knotsU;return L.last(t)-L.first(t)<this._knotTolU}return!1},empty:function(){return!1},__class__:$};var ee=e.core.Mat=function(){};(n["verb.core.Mat"]=ee).__name__="verb.core.Mat",ee.mul=function(e,t){for(var n=[],r=0,i=t.length;r<i;){var o=r++;n.push(pe.mul(e,t[o]))}return n},ee.mult=function(e,t){for(var n,r,i,o,s=e.length,a=t.length,u=t[0].length,l=[],h=s-1,c=0,f=0;0<=h;){for(n=[],r=e[h],f=u-1;0<=f;){for(i=r[a-1]*t[a-1][f],c=a-2;1<=c;)o=c-1,i+=r[c]*t[c][f]+r[o]*t[o][f],c-=2;0==c&&(i+=r[0]*t[0][f]),n[f]=i,--f}l[h]=n,--h}return l},ee.add=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(pe.add(e[o],t[o]))}return n},ee.div=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(pe.div(e[o],t))}return n},ee.sub=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(pe.sub(e[o],t[o]))}return n},ee.dot=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(pe.dot(e[o],t))}return n},ee.identity=function(e){for(var t=pe.zeros2d(e,e),n=0,r=e;n<r;){var i=n++;t[i][i]=1}return t},ee.transpose=function(e){if(0==e.length)return[];for(var t=[],n=0,r=e[0].length;n<r;){for(var i=n++,o=[],s=0,a=e.length;s<a;){var u=s++;o.push(e[u][i])}t.push(o)}return t},ee.solve=function(e,t){return ee.LUsolve(ee.LU(e),t)},ee.LUsolve=function(e,t){for(var n,r,i,o,s=e.LU,a=s.length,u=t.slice(),l=e.P,h=a-1;-1!=h;)u[h]=t[h],--h;for(h=0;h<a;){for(r=l[h],l[h]!=h&&(o=u[h],u[h]=u[r],u[r]=o),i=s[h],n=0;n<h;)u[h]-=u[n]*i[n],++n;++h}for(h=a-1;0<=h;){for(i=s[h],n=h+1;n<a;)u[h]-=u[n]*i[n],++n;u[h]/=i[h],--h}return u},ee.LU=function(e){Math.abs;for(var t,n,r,i,o,s,a,u,l=[],h=0,c=e.length;h<c;){var f=h++;l.push(e[f].slice())}for(var v=(e=l).length,_=v-1,d=[],g=0;g<v;){for(o=e[s=g],u=Math.abs(o[g]),n=g+1;n<v;)u<(r=Math.abs(e[n][g]))&&(u=r,s=n),++n;for((d[g]=s)!=g&&(e[g]=e[s],e[s]=o,o=e[g]),i=o[g],t=g+1;t<v;)e[t][g]/=i,++t;for(t=g+1;t<v;){for(a=e[t],n=g+1;n<_;)a[n]-=a[g]*o[n],a[++n]-=a[g]*o[n],++n;n==_&&(a[n]-=a[g]*o[n]),++t}++g}return new te(e,d)};var te=function(e,t){this.LU=e,this.P=t};(n["verb.core._Mat.LUDecomp"]=te).__name__="verb.core._Mat.LUDecomp",te.prototype={__class__:te};var ne=e.core.Mesh=function(){};(n["verb.core.Mesh"]=ne).__name__="verb.core.Mesh",ne.getTriangleNorm=function(e,t){var n=e[t[0]],r=e[t[1]],t=e[t[2]],r=pe.sub(r,n),n=pe.sub(t,n),n=pe.cross(r,n);return pe.mul(1/pe.norm(n),n)},ne.makeMeshAabb=function(e,t){for(var n=new v,r=0;r<t.length;){var i=t[r];++r,n.add(e.points[e.faces[i][0]]),n.add(e.points[e.faces[i][1]]),n.add(e.points[e.faces[i][2]])}return n},ne.sortTrianglesOnLongestAxis=function(e,t,n){for(var r=e.getLongestAxis(),i=[],o=0;o<n.length;){var s=n[o];++o;var a=ne.getMinCoordOnAxis(t.points,t.faces[s],r);i.push(new p(a,s))}i.sort(function(e,t){e=e.item0,t=t.item0;return e==t?0:t<e?1:-1});for(var u=[],o=0,l=i.length;o<l;){var h=o++;u.push(i[h].item1)}return u},ne.getMinCoordOnAxis=function(e,t,n){var r=1/0,i=e[t[0]][n];return i<r&&(r=i),(i=e[t[1]][n])<r&&(r=i),(i=e[t[2]][n])<r&&(r=i),r},ne.getTriangleCentroid=function(e,t){var n=[0,0,0];return n[0]+=e[t[0]][0],n[1]+=e[t[0]][1],n[2]+=e[t[0]][2],n[0]+=e[t[1]][0],n[1]+=e[t[1]][1],n[2]+=e[t[1]][2],n[0]+=e[t[2]][0],n[1]+=e[t[2]][1],n[2]+=e[t[2]][2],n[0]/=3,n[1]/=3,n[2]/=3,n},ne.triangleUVFromPoint=function(e,t,n){var r=e.faces[t],i=e.points[r[0]],o=e.points[r[1]],s=e.points[r[2]],a=e.uvs[r[0]],u=e.uvs[r[1]],t=e.uvs[r[2]],e=pe.sub(i,n),r=pe.sub(o,n),n=pe.sub(s,n),i=pe.norm(pe.cross(pe.sub(i,o),pe.sub(i,s))),s=pe.norm(pe.cross(r,n))/i,n=pe.norm(pe.cross(n,e))/i,i=pe.norm(pe.cross(e,r))/i;return pe.add(pe.mul(s,a),pe.add(pe.mul(n,u),pe.mul(i,t)))};var re=function(e,t){if(this._empty=!1,this._face=-1,null==t){for(var n=[],r=0,i=e.faces.length;r<i;){var o=r++;n.push(o)}t=n}var s;this._boundingBox=ne.makeMeshAabb(e,t),t.length<1?this._empty=!0:t.length<2?this._face=t[0]:(s=ne.sortTrianglesOnLongestAxis(this._boundingBox,e,t),t=L.left(s),s=L.right(s),this._children=new p(new re(e,t),new re(e,s)))};(n["verb.core.MeshBoundingBoxTree"]=re).__name__="verb.core.MeshBoundingBoxTree",re.__interfaces__=[d],re.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},yield:function(){return this._face},indivisible:function(e){return null==this._children},empty:function(){return this._empty},__class__:re};var ie=e.core.Minimizer=function(){};(n["verb.core.Minimizer"]=ie).__name__="verb.core.Minimizer",ie.uncmin=function(t,e,n,r,i){null==n&&(n=1e-8),null==r&&(r=function(e){return ie.numericalGradient(t,e)}),null==i&&(i=1e3);var o,s,a,u=(e=e.slice(0)).length,l=t(e),h=l;if(isNaN(l))throw U.thrown("uncmin: f(x0) is a NaN!");n=Math.max(n,D.EPSILON);for(var c,f,v,_,d,g,p=ee.identity(u),m=0,b=[],w="",S=r(e);m<i;){if(!pe.all(pe.finite(S))){w="Gradient has Infinity or NaN";break}if(s=pe.neg(ee.dot(p,S)),!pe.all(pe.finite(s))){w="Search direction has Infinity or NaN";break}if((g=pe.norm(s))<n){w="Newton step smaller than tol";break}for(d=1,o=pe.dot(S,s),c=e;m<i&&!(d*g<n)&&(b=pe.mul(d,s),c=pe.add(e,b),.1*d*o<=(h=t(c))-l||isNaN(h));)d*=.5,++m;if(d*g<n){w="Line search step size smaller than tol";break}if(m==i){w="maxit reached during line search";break}a=r(c),f=pe.sub(a,S),_=pe.dot(f,b),v=ee.dot(p,f),p=ee.sub(ee.add(p,ee.mul((_+pe.dot(f,v))/(_*_),ie.tensor(b,b))),ee.div(ee.add(ie.tensor(v,b),ie.tensor(b,v)),_)),e=c,l=h,S=a,++m}return new oe(e,l,S,p,m,w)},ie.numericalGradient=function(e,t){var n=t.length,r=e(t);if(NaN==r)throw U.thrown("gradient: f(x) is a NaN!");for(var i,o,s,a,u,l,h,c=t.slice(0),f=[],v=0,_=0,d=n;_<d;)for(var g=_++,p=Math.max(1e-6*r,1e-8);;){if(20<++v)throw U.thrown("Numerical gradient fails");if(c[g]=t[g]+p,i=e(c),c[g]=t[g]-p,o=e(c),c[g]=t[g],isNaN(i)||isNaN(o))p/=16;else{if(f[g]=(i-o)/(2*p),s=t[g]-p,a=t[g],h=t[g]+p,u=(i-r)/p,l=(r-o)/p,h=pe.max([Math.abs(f[g]),Math.abs(r),Math.abs(i),Math.abs(o),Math.abs(s),Math.abs(a),Math.abs(h),1e-8]),!(.001<Math.min(pe.max([Math.abs(u-f[g]),Math.abs(l-f[g]),Math.abs(u-l)])/h,p/h)))break;p/=16}}return f},ie.tensor=function(e,t){for(var n,r,i=e.length,o=t.length,s=[],a=i-1;0<=a;){n=[],r=e[a];for(var u=o-1;3<=u;)n[u]=r*t[u],n[--u]=r*t[u],n[--u]=r*t[u],n[--u]=r*t[u],--u;for(;0<=u;)n[u]=r*t[u],--u;s[a]=n,--a}return s};var oe=function(e,t,n,r,i,o){this.solution=e,this.value=t,this.gradient=n,this.invHessian=r,this.iterations=i,this.message=o};(n["verb.core.MinimizationResult"]=oe).__name__="verb.core.MinimizationResult",oe.prototype={__class__:oe},a=function(){},(n["verb.core.ISerializable"]=a).__name__="verb.core.ISerializable",a.__isInterface__=!0,a.prototype={__class__:a},d=e.core.Deserializer=function(){},(n["verb.core.Deserializer"]=d).__name__="verb.core.Deserializer",d.deserialize=function(e){return new A(e).unserialize()};var se=e.core.Trig=function(){};(n["verb.core.Trig"]=se).__name__="verb.core.Trig",se.isPointInPlane=function(e,t,n){return Math.abs(pe.dot(pe.sub(e,t.origin),t.normal))<n},se.distToSegment=function(e,t,n){n=se.segmentClosestPoint(t,e,n,0,1);return pe.dist(t,n.pt)},se.rayClosestPoint=function(e,t,n){e=pe.sub(e,t),e=pe.dot(e,n);return pe.add(t,pe.mul(e,n))},se.distToRay=function(e,t,n){n=se.rayClosestPoint(e,t,n),e=pe.sub(n,e);return pe.norm(e)},se.threePointsAreFlat=function(e,t,n,r){t=pe.sub(t,e),e=pe.sub(n,e),e=pe.cross(t,e);return pe.dot(e,e)<r},se.segmentClosestPoint=function(e,t,n,r,i){var o=pe.sub(n,t),s=pe.norm(o);if(s<D.EPSILON)return{u:r,pt:t};var a=t,o=pe.mul(1/s,o),e=pe.sub(e,a),e=pe.dot(e,o);return e<0?{u:r,pt:t}:s<e?{u:i,pt:n}:{u:r+(i-r)*e/s,pt:pe.add(a,pe.mul(e,o))}};var pe=e.core.Vec=function(){};(n["verb.core.Vec"]=pe).__name__="verb.core.Vec",pe.angleBetween=function(e,t){return Math.acos(pe.dot(e,t)/(pe.norm(e)*pe.norm(t)))},pe.positiveAngleBetween=function(e,t,n){var r=pe.cross(e,t),i=pe.norm(e)*pe.norm(t),e=pe.dot(e,t),t=pe.norm(r)/i,i=e/i,i=Math.atan2(t,i),r=pe.dot(n,r);return Math.abs(r)<D.EPSILON||0<r?i:-i},pe.signedAngleBetween=function(e,t,n){var r=pe.cross(e,t),i=pe.norm(e)*pe.norm(t),e=pe.dot(e,t),t=pe.norm(r)/i,i=e/i,i=Math.atan2(t,i);return 0<pe.dot(n,r)?i:2*Math.PI-i},pe.angleBetweenNormalized2d=function(e,t){var n=e[0]*t[1]-e[1]*t[0];return Math.atan2(n,pe.dot(e,t))},pe.domain=function(e){return L.last(e)-L.first(e)},pe.range=function(e){for(var t=[],n=0,r=0,i=e;r<i;){r++;t.push(n),n+=1}return t},pe.span=function(e,t,n){if(null==n)return[];if(n<D.EPSILON)return[];if(t<e&&0<n)return[];if(e<t&&n<0)return[];for(var r=[],i=e;i<=t;)r.push(i),i+=n;return r},pe.neg=function(e){for(var t=new Array(e.length),n=0,r=e.length;n<r;){var i=n++;t[i]=-e[i]}return t},pe.min=function(e){return w.fold(e,function(e,t){return Math.min(e,t)},1/0)},pe.max=function(e){return w.fold(e,function(e,t){return Math.max(e,t)},-1/0)},pe.all=function(e){return w.fold(e,function(e,t){return!!t&&e},!0)},pe.finite=function(e){for(var t=new Array(e.length),n=0,r=e.length;n<r;){var i=n++;t[i]=isFinite(e[i])}return t},pe.onRay=function(e,t,n){return pe.add(e,pe.mul(n,t))},pe.lerp=function(e,t,n){return pe.add(pe.mul(e,t),pe.mul(1-e,n))},pe.normalized=function(e){return pe.div(e,pe.norm(e))},pe.cross=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},pe.dist=function(e,t){return pe.norm(pe.sub(e,t))},pe.distSquared=function(e,t){return pe.normSquared(pe.sub(e,t))},pe.sum=function(e){return w.fold(e,function(e,t){return t+e},0)},pe.addAll=function(e){var t=xe(e);if(!t.hasNext())return null;t=t.next().length;return w.fold(e,function(e,t){return pe.add(t,e)},pe.rep(t,0))},pe.addAllMutate=function(e){for(var t=e[0],n=1,r=e.length;n<r;){var i=n++;pe.addMutate(t,e[i])}},pe.addMulMutate=function(e,t,n){for(var r=0,i=e.length;r<i;){var o=r++;e[o]+=t*n[o]}},pe.subMulMutate=function(e,t,n){for(var r=0,i=e.length;r<i;){var o=r++;e[o]-=t*n[o]}},pe.addMutate=function(e,t){for(var n=0,r=e.length;n<r;){var i=n++;e[i]+=t[i]}},pe.subMutate=function(e,t){for(var n=0,r=e.length;n<r;){var i=n++;e[i]-=t[i]}},pe.mulMutate=function(e,t){for(var n=0,r=t.length;n<r;)t[n++]*=e},pe.norm=function(e){e=pe.normSquared(e);return 0!=e?Math.sqrt(e):e},pe.normSquared=function(e){return w.fold(e,function(e,t){return t+e*e},0)},pe.rep=function(e,t){for(var n=[],r=0,i=e;r<i;){r++;n.push(t)}return n},pe.fill=function(e,t){for(var n=[],r=0,i=e;r<i;){r++;n.push(t)}return n},pe.zeros1d=function(e){for(var t=[],n=0,r=e;n<r;){n++;t.push(0)}return t},pe.zeros2d=function(e,t){for(var n=[],r=0,i=e;r<i;){r++;n.push(pe.zeros1d(t))}return n},pe.zeros3d=function(e,t,n){for(var r=[],i=0,o=e;i<o;){i++;r.push(pe.zeros2d(t,n))}return r},pe.dot=function(e,t){for(var n=0,r=0,i=e.length;r<i;){var o=r++;n+=e[o]*t[o]}return n},pe.add=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(e[o]+t[o])}return n},pe.mul=function(e,t){for(var n=[],r=0,i=t.length;r<i;){var o=r++;n.push(e*t[o])}return n},pe.div=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(e[o]/t)}return n},pe.sub=function(e,t){for(var n=[],r=0,i=e.length;r<i;){var o=r++;n.push(e[o]-t[o])}return n},pe.isZero=function(e){for(var t=0,n=e.length;t<n;){var r=t++;if(Math.abs(e[r])>D.TOLERANCE)return!1}return!0},pe.sortedSetUnion=function(e,t){for(var n,r=[],i=0,o=0;i<e.length||o<t.length;)i>=e.length?(r.push(t[o]),++o):o>=t.length?(r.push(e[i]),++i):(n=e[i]-t[o],Math.abs(n)<D.EPSILON?(r.push(e[i]),++i,++o):0<n?(r.push(t[o]),++o):(r.push(e[i]),++i));return r},pe.sortedSetSub=function(e,t){for(var n=[],r=0,i=0;r<e.length;)!(i>=t.length)&&Math.abs(e[r]-t[i])<D.EPSILON?(++r,++i):(n.push(e[r]),++r);return n};var ae=e.eval.Analyze=function(){};(n["verb.eval.Analyze"]=ae).__name__="verb.eval.Analyze",ae.knotMultiplicities=function(e){for(var t=[new ue(e[0],0)],n=t[0],r=0;r<e.length;){var i=e[r];++r,Math.abs(i-n.knot)>D.EPSILON&&(n=new ue(i,0),t.push(n)),n.inc()}return t},ae.isRationalSurfaceClosed=function(e,t){null==t&&(t=!0);for(var n=t?e.controlPoints:ee.transpose(e.controlPoints),r=0,i=n[0].length;r<i;){var o=r++;if(!(pe.dist(L.first(n)[o],L.last(n)[o])<D.EPSILON))return!1}return!0},ae.rationalSurfaceClosestPoint=function(e,t){t=ae.rationalSurfaceClosestParam(e,t);return fe.rationalSurfacePoint(e,t[0],t[1])},ae.rationalSurfaceClosestParam=function(e,t){for(var n,r,i=0,o=e.knotsU[0],s=L.last(e.knotsU),a=e.knotsV[0],u=L.last(e.knotsV),l=ae.isRationalSurfaceClosed(e),h=ae.isRationalSurfaceClosed(e,!1),c=be.rationalSurfaceAdaptive(e,new we),f=1/0,v=0,_=c.points.length;v<_;){var d=v++,g=c.points[d],g=pe.normSquared(pe.sub(t,g));g<f&&(f=g,r=c.uvs[d])}for(var p,m,b,w,S,y,P,k,C,x;i<5;){x=r,n=fe.rationalSurfaceDerivatives(e,x[0],x[1],2),E=pe.sub(n[0][0],t);var M=pe.norm(E),z=pe.dot(n[1][0],E),A=pe.norm(n[1][0])*M,I=pe.dot(n[0][1],E),N=pe.norm(n[0][1])*M;if(M<1e-4&&z/A<5e-4&&I/N<5e-4)return r;var E=(p=r,b=E,C=k=P=y=S=w=void 0,w=(m=n)[1][0],S=m[0][1],y=m[2][0],P=m[0][2],k=m[1][1],C=m[1][1],m=[-pe.dot(w,b),-pe.dot(S,b)],b=[[pe.dot(w,w)+pe.dot(y,b),pe.dot(w,S)+pe.dot(k,b)],[pe.dot(w,S)+pe.dot(C,b),pe.dot(S,S)+pe.dot(P,b)]],m=ee.solve(b,m),pe.add(m,p));if(E[0]<o?E=l?[s-(E[0]-o),E[1]]:[o+D.EPSILON,E[1]]:E[0]>s&&(E=l?[o+(E[0]-s),E[1]]:[s-D.EPSILON,E[1]]),E[1]<a?E=h?[E[0],u-(E[1]-a)]:[E[0],a+D.EPSILON]:E[1]>u&&(E=h?[E[0],a+(E[0]-u)]:[E[0],u-D.EPSILON]),pe.norm(pe.mul(E[0]-r[0],n[1][0]))+pe.norm(pe.mul(E[1]-r[1],n[0][1]))<1e-4)return r;r=E,++i}return r},ae.rationalCurveClosestPoint=function(e,t){return fe.rationalCurvePoint(e,ae.rationalCurveClosestParam(e,t))},ae.rationalCurveClosestParam=function(e,t){for(var n=1/0,r=0,i=be.rationalCurveRegularSample(e,e.controlPoints.length*e.degree,!0),o=0,s=i.length-1;o<s;){var a=i[d=o++][0],u=i[d+1][0],l=i[d].slice(1),h=i[d+1].slice(1),a=se.segmentClosestPoint(t,l,h,a,u),u=pe.norm(pe.sub(t,a.pt));u<n&&(n=u,r=a.u)}for(var c,f,v,_,d=0,g=e.knots[0],p=L.last(e.knots),m=pe.normSquared(pe.sub(e.controlPoints[0],L.last(e.controlPoints)))<D.EPSILON,b=r;d<5;){_=b,c=fe.rationalCurveDerivatives(e,_,2),y=pe.sub(c[0],t);var w=pe.norm(y),S=pe.dot(c[1],y)/(pe.norm(c[1])*w),w=w<1e-4,S=Math.abs(S)<5e-4;if(w&&S)return b;var y=(f=c,v=y,b-pe.dot(f[1],v)/(pe.dot(f[2],v)+pe.dot(f[1],f[1])));if(y<g?y=m?p-(y-g):g:p<y&&(y=m?g+(y-p):p),pe.norm(pe.mul(y-b,c[1]))<1e-4)return b;b=y,++d}return b},ae.rationalCurveParamAtArcLength=function(e,t,n,r,i){if(null==n&&(n=.001),t<D.EPSILON)return e.knots[0];for(var o=null!=r?r:me.decomposeCurveIntoBeziers(e),s=0,a=(o[s],-D.EPSILON),u=null!=i?i:[];a<t&&s<o.length;){if(u[s]=s<u.length?u[s]:ae.rationalBezierCurveArcLength(e),t<(a+=u[s])+D.EPSILON)return ae.rationalBezierCurveParamAtArcLength(e,t,n,u[s]);++s}return-1},ae.rationalBezierCurveParamAtArcLength=function(e,t,n,r){if(t<0)return e.knots[0];r=null!=r?r:ae.rationalBezierCurveArcLength(e);if(r<t)return L.last(e.knots);for(var i,o,s=e.knots[0],a=0,u=L.last(e.knots),l=r,h=null!=n?n:2*D.TOLERANCE;h<l-a;)i=(s+u)/2,t<(o=ae.rationalBezierCurveArcLength(e,i))?(u=i,l=o):(s=i,a=o);return(s+u)/2},ae.rationalCurveArcLength=function(e,t,n){null==n&&(n=16),null==t&&(t=L.last(e.knots));for(var r=me.decomposeCurveIntoBeziers(e),i=0,o=r[0],s=0;i<r.length&&o.knots[0]+D.EPSILON<t;){var a=Math.min(L.last(o.knots),t);s+=ae.rationalBezierCurveArcLength(o,a,n),o=r[++i]}return s},ae.rationalBezierCurveArcLength=function(e,t,n){null==n&&(n=16);for(var r=((null==t?L.last(e.knots):t)-e.knots[0])/2,i=0,o=e.degree+n,s=0,a=o;s<a;){var u=s++,l=r*ae.Tvalues[o][u]+r+e.knots[0],l=fe.rationalCurveDerivatives(e,l,1);i+=ae.Cvalues[o][u]*pe.norm(l[1])}return r*i};var ue=e.eval.KnotMultiplicity=function(e,t){this.knot=e,this.mult=t};(n["verb.eval.KnotMultiplicity"]=ue).__name__="verb.eval.KnotMultiplicity",ue.prototype={inc:function(){this.mult++},__class__:ue};var le=e.eval.Check=function(){};(n["verb.eval.Check"]=le).__name__="verb.eval.Check",le.isValidKnotVector=function(e,t){if(0==e.length)return!1;if(e.length<2*(t+1))return!1;for(var n=L.first(e),r=0,i=t+1;r<i;){var o=r++;if(Math.abs(e[o]-n)>D.EPSILON)return!1}n=L.last(e);for(r=e.length-t-1,i=e.length;r<i;){o=r++;if(Math.abs(e[o]-n)>D.EPSILON)return!1}return le.isNonDecreasing(e)},le.isNonDecreasing=function(e){for(var t=L.first(e),n=0,r=e.length;n<r;){var i=n++;if(e[i]<t-D.EPSILON)return!1;t=e[i]}return!0},le.isValidNurbsCurveData=function(e){if(null==e.controlPoints)throw U.thrown("Control points array cannot be null!");if(null==e.degree)throw U.thrown("Degree cannot be null!");if(e.degree<1)throw U.thrown("Degree must be greater than 1!");if(null==e.knots)throw U.thrown("Knots cannot be null!");if(e.knots.length!=e.controlPoints.length+e.degree+1)throw U.thrown("controlPoints.length + degree + 1 must equal knots.length!");if(!le.isValidKnotVector(e.knots,e.degree))throw U.thrown("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return e},le.isValidNurbsSurfaceData=function(e){if(null==e.controlPoints)throw U.thrown("Control points array cannot be null!");if(null==e.degreeU)throw U.thrown("DegreeU cannot be null!");if(null==e.degreeV)throw U.thrown("DegreeV cannot be null!");if(e.degreeU<1)throw U.thrown("DegreeU must be greater than 1!");if(e.degreeV<1)throw U.thrown("DegreeV must be greater than 1!");if(null==e.knotsU)throw U.thrown("KnotsU cannot be null!");if(null==e.knotsV)throw U.thrown("KnotsV cannot be null!");if(e.knotsU.length!=e.controlPoints.length+e.degreeU+1)throw U.thrown("controlPointsU.length + degreeU + 1 must equal knotsU.length!");if(e.knotsV.length!=e.controlPoints[0].length+e.degreeV+1)throw U.thrown("controlPointsV.length + degreeV + 1 must equal knotsV.length!");if(!le.isValidKnotVector(e.knotsU,e.degreeU)||!le.isValidKnotVector(e.knotsV,e.degreeV))throw U.thrown("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return e};var he=e.eval.Divide=function(){};(n["verb.eval.Divide"]=he).__name__="verb.eval.Divide",he.surfaceSplit=function(e,t,n){var r,i,o;null==n&&(n=!1);for(var s=[],a=0,u=(i=n?(o=e.controlPoints,r=e.knotsV,e.degreeV):(o=ee.transpose(e.controlPoints),r=e.knotsU,e.degreeU))+1;a<u;){a++;s.push(t)}for(var l=s,h=[],c=[],f=fe.knotSpan(i,t,r),v=null,s=0;s<o.length;){var _=o[s];++s,v=me.curveKnotRefine(new ge(i,r,_),l),h.push(v.controlPoints.slice(0,f+1)),c.push(v.controlPoints.slice(f+1))}var d=v.knots.slice(0,f+i+2),g=v.knots.slice(f+1);return n?[new O(e.degreeU,i,e.knotsU.slice(),d,h),new O(e.degreeU,i,e.knotsU.slice(),g,c)]:(h=ee.transpose(h),c=ee.transpose(c),[new O(i,e.degreeV,d,e.knotsV.slice(),h),new O(i,e.degreeV,g,e.knotsV.slice(),c)])},he.curveSplit=function(e,t){for(var n=e.degree,r=(e.controlPoints,e.knots),i=[],o=0,s=n+1;o<s;){o++;i.push(t)}var a=me.curveKnotRefine(e,i),u=fe.knotSpan(n,t,r),l=a.knots.slice(0,u+n+2),e=a.knots.slice(u+1),r=a.controlPoints.slice(0,u+1),u=a.controlPoints.slice(u+1);return[new ge(n,l,r),new ge(n,e,u)]},he.rationalCurveByEqualArcLength=function(e,t){t=ae.rationalCurveArcLength(e)/t;return he.rationalCurveByArcLength(e,t)},he.rationalCurveByArcLength=function(e,t){for(var n=me.decomposeCurveIntoBeziers(e),r=new Array(n.length),i=0,o=n.length;i<o;)r[c=i++]=ae.rationalBezierCurveArcLength(n[c]);var s=r,a=pe.sum(s),u=[new ce(e.knots[0],0)];if(a<t)return u;for(var l,h=t,c=0,f=h,v=0,_=0;c<n.length;){for(v+=s[c];f<v+D.EPSILON;)l=ae.rationalBezierCurveParamAtArcLength(n[c],f-_,D.TOLERANCE,s[c]),u.push(new ce(l,f)),f+=h;_+=s[c],++c}return u};var ce=e.eval.CurveLengthSample=function(e,t){this.u=e,this.len=t};(n["verb.eval.CurveLengthSample"]=ce).__name__="verb.eval.CurveLengthSample",ce.prototype={__class__:ce};var fe=e.eval.Eval=function(){};(n["verb.eval.Eval"]=fe).__name__="verb.eval.Eval",fe.rationalCurveTangent=function(e,t){return fe.rationalCurveDerivatives(e,t,1)[1]},fe.rationalSurfaceNormal=function(e,t,n){n=fe.rationalSurfaceDerivatives(e,t,n,1);return pe.cross(n[1][0],n[0][1])},fe.rationalSurfaceDerivatives=function(e,t,n,r){null==r&&(r=1);for(var t=fe.surfaceDerivatives(e,t,n,r),i=fe.rational2d(t),o=fe.weight2d(t),s=[],a=i[0][0].length,u=0,l=r+1;u<l;){var h=u++;s.push([]);for(var c=0,f=r-h+1;c<f;){for(var v=c++,n=i[h][v],_=1,d=1+v;_<d;){var g=_++;pe.subMulMutate(n,de.get(v,g)*o[0][g],s[h][v-g])}for(var p=1,m=1+h;p<m;){var b=p++;pe.subMulMutate(n,de.get(h,b)*o[b][0],s[h-b][v]);for(var w=pe.zeros1d(a),S=1,y=1+v;S<y;){var P=S++;pe.addMulMutate(w,de.get(v,P)*o[b][P],s[h-b][v-P])}pe.subMulMutate(n,de.get(h,b),w)}pe.mulMutate(1/o[0][0],n),s[h].push(n)}}return s},fe.rationalSurfacePoint=function(e,t,n){return fe.dehomogenize(fe.surfacePoint(e,t,n))},fe.rationalCurveDerivatives=function(e,t,n){null==n&&(n=1);for(var t=fe.curveDerivatives(e,t,n),r=fe.rational1d(t),i=fe.weight1d(t),o=0,s=[],a=0,u=n+1;a<u;){for(var l=r[o=a++],h=1,c=1+o;h<c;){var f=h++;pe.subMulMutate(l,de.get(o,f)*i[f],s[o-f])}pe.mulMutate(1/i[0],l),s.push(l)}return s},fe.rationalCurvePoint=function(e,t){return fe.dehomogenize(fe.curvePoint(e,t))},fe.surfaceDerivatives=function(e,t,n,r){var i=e.knotsU.length-e.degreeU-2,o=e.knotsV.length-e.degreeV-2;return fe.surfaceDerivativesGivenNM(i,o,e,t,n,r)},fe.surfaceDerivativesGivenNM=function(e,t,n,r,i,o){var s=n.degreeU,a=n.degreeV,u=n.controlPoints,l=n.knotsU,h=n.knotsV;if(!fe.areValidRelations(s,u.length,l.length)||!fe.areValidRelations(a,u[0].length,h.length))throw U.thrown("Invalid relations between control points, knot vector, and n");for(var c=u[0][0].length,n=o<s?o:s,f=o<a?o:a,v=pe.zeros3d(o+1,o+1,c),_=fe.knotSpanGivenN(e,s,r,l),d=fe.knotSpanGivenN(t,a,i,h),g=fe.derivativeBasisFunctionsGivenNI(_,r,s,e,l),p=fe.derivativeBasisFunctionsGivenNI(d,i,a,t,h),m=pe.zeros2d(a+1,c),b=0,w=n+1;b<w;){for(var S=b++,y=0,P=a+1;y<P;){var k=y++;m[k]=pe.zeros1d(c);for(var C=0,x=s+1;C<x;){var M=C++;pe.addMulMutate(m[k],g[S][M],u[_-s+M][d-a+k])}}for(var z=o-S,A=0,I=(z<f?z:f)+1;A<I;){var N=A++;v[S][N]=pe.zeros1d(c);for(var E=0,V=a+1;E<V;){var T=E++;pe.addMulMutate(v[S][N],p[N][T],m[T])}}}return v},fe.surfacePoint=function(e,t,n){var r=e.knotsU.length-e.degreeU-2,i=e.knotsV.length-e.degreeV-2;return fe.surfacePointGivenNM(r,i,e,t,n)},fe.surfacePointGivenNM=function(e,t,n,r,i){var o=n.degreeU,s=n.degreeV,a=n.controlPoints,u=n.knotsU,n=n.knotsV;if(!fe.areValidRelations(o,a.length,u.length)||!fe.areValidRelations(s,a[0].length,n.length))throw U.thrown("Invalid relations between control points, knot vector, and n");for(var l=a[0][0].length,e=fe.knotSpanGivenN(e,o,r,u),h=fe.knotSpanGivenN(t,s,i,n),c=fe.basisFunctionsGivenKnotSpanIndex(e,r,o,u),f=fe.basisFunctionsGivenKnotSpanIndex(h,i,s,n),v=e-o,_=pe.zeros1d(l),d=pe.zeros1d(l),g=0,p=s+1;g<p;){for(var m=g++,d=pe.zeros1d(l),b=h-s+m,w=0,S=o+1;w<S;){var y=w++;pe.addMulMutate(d,c[y],a[v+y][b])}pe.addMulMutate(_,f[m],d)}return _},fe.curveRegularSamplePoints=function(e,t){for(var n=fe.curveDerivatives(e,e.knots[0],e.degree),r=1/t,e=r*r,i=n[0],o=pe.mul(r,n[1]),s=pe.mul(.5*e,n[2]),a=pe.mul(e*r*.5,n[3]),u=pe.add(s,s),l=pe.add(a,a),h=pe.mul(.3333333333333333,a),c=[],f=0,v=t+1;f<v;){f++;c.push(fe.dehomogenize(i)),pe.addAllMutate([i,o,s,h]),pe.addAllMutate([o,u,a]),pe.addAllMutate([u,l]),pe.addAllMutate([s,a])}return c},fe.curveRegularSamplePoints2=function(e,t){for(var n=fe.curveDerivatives(e,e.knots[0],e.degree),r=1/t,e=r*r,i=n[0],o=pe.mul(r,n[1]),s=pe.mul(.5*e,n[2]),a=pe.mul(e*r*.5,n[3]),u=pe.add(s,s),l=pe.add(a,a),h=pe.mul(.3333333333333333,a),c=[],f=0,v=t+1;f<v;){f++;c.push(fe.dehomogenize(i)),pe.addAllMutate([i,o,s,h]),pe.addAllMutate([o,u,a]),pe.addAllMutate([u,l]),pe.addAllMutate([s,a])}return c},fe.rationalSurfaceRegularSampleDerivatives=function(e,t,n,r){for(var i=fe.surfaceRegularSampleDerivatives(e,t,n,r),o=[],s=n+1,a=r+1,u=0,l=t+1;u<l;){var h=u++,c=[];o.push(c);for(var f=0,v=s;f<v;){for(var _=f++,_=i[h][_],d=fe.rational2d(_),g=fe.weight2d(_),p=[],m=d[0][0].length,b=0,w=a;b<w;){var S=b++;p.push([]);for(var y=0,P=a-S;y<P;){for(var k=y++,C=d[S][k],x=1,M=1+k;x<M;){var z=x++;pe.subMulMutate(C,de.get(k,z)*g[0][z],p[S][k-z])}for(var A=1,I=1+S;A<I;){var N=A++;pe.subMulMutate(C,de.get(S,N)*g[N][0],p[S-N][k]);for(var E=pe.zeros1d(m),V=1,T=1+k;V<T;){var B=V++;pe.addMulMutate(E,de.get(k,B)*g[N][B],p[S-N][k-B])}pe.subMulMutate(C,de.get(S,N),E)}pe.mulMutate(1/g[0][0],C),p[S].push(C)}}c.push(p)}}return o},fe.surfaceRegularSampleDerivatives=function(e,t,n,r){for(var i=e.degreeU,o=e.degreeV,s=e.controlPoints,a=e.knotsU,e=e.knotsV,u=s[0][0].length,a=(L.last(a),a[0],L.last(e),e[0],fe.regularlySpacedDerivativeBasisFunctions(i,a,t)),l=a.item0,h=a.item1,e=fe.regularlySpacedDerivativeBasisFunctions(o,e,n),c=e.item0,f=e.item1,v=[],_=n+1,d=0,g=t+1;d<g;){var p=d++,m=[];v.push(m);for(var b=0,w=_;b<w;){var S=b++;m.push(fe.surfaceDerivativesGivenBasesKnotSpans(i,o,s,l[p],c[S],h[p],f[S],u,r))}}return v},fe.rationalSurfaceRegularSamplePoints=function(e,t,n){return fe.dehomogenize2d(fe.surfaceRegularSamplePoints(e,t,n))},fe.surfaceRegularSamplePoints=function(e,t,n){for(var r=e.degreeU,i=e.degreeV,o=e.controlPoints,s=e.knotsU,e=e.knotsV,a=o[0][0].length,s=(L.last(s),s[0],L.last(e),e[0],fe.regularlySpacedBasisFunctions(r,s,t)),u=s.item0,l=s.item1,e=fe.regularlySpacedBasisFunctions(i,e,n),h=e.item0,c=e.item1,f=[],v=n+1,_=0,d=t+1;_<d;){var g=_++,p=[];f.push(p);for(var m=0,b=v;m<b;){var w=m++;p.push(fe.surfacePointGivenBasesKnotSpans(r,i,o,u[g],h[w],l[g],c[w],a))}}return f},fe.regularlySpacedBasisFunctions=function(e,t,n){for(var r=t.length-e-2,i=(L.last(t)-t[0])/n,o=[],s=[],a=t[0],u=fe.knotSpanGivenN(r,e,a,t),l=0,h=n+1;l<h;){for(l++;a>=t[u+1];)++u;s.push(u),o.push(fe.basisFunctionsGivenKnotSpanIndex(u,a,e,t)),a+=i}return new p(s,o)},fe.regularlySpacedDerivativeBasisFunctions=function(e,t,n){for(var r=t.length-e-2,i=(L.last(t)-t[0])/n,o=[],s=[],a=t[0],u=fe.knotSpanGivenN(r,e,a,t),l=0,h=n+1;l<h;){for(l++;a>=t[u+1];)++u;s.push(u),o.push(fe.derivativeBasisFunctionsGivenNI(u,a,e,r,t)),a+=i}return new p(s,o)},fe.surfacePointGivenBasesKnotSpans=function(e,t,n,r,i,o,s,a){for(var u=pe.zeros1d(a),l=r-e,h=i-t,c=0,f=t+1;c<f;){for(var v=c++,_=pe.zeros1d(a),d=0,g=e+1;d<g;){var p=d++;pe.addMulMutate(_,o[p],n[l+p][h])}++h,pe.addMulMutate(u,s[v],_)}return u},fe.surfaceDerivativesGivenBasesKnotSpans=function(e,t,n,r,i,o,s,a,u){for(var a=n[0][0].length,l=u<e?u:e,h=u<t?u:t,c=pe.zeros3d(l+1,h+1,a),f=pe.zeros2d(t+1,a),v=0,_=l+1;v<_;){for(var d=v++,g=0,p=t+1;g<p;){var m=g++;f[m]=pe.zeros1d(a);for(var b=0,w=e+1;b<w;){var S=b++;pe.addMulMutate(f[m],o[d][S],n[r-e+S][i-t+m])}}for(var y=u-d,P=0,k=(y<h?y:h)+1;P<k;){var C=P++;c[d][C]=pe.zeros1d(a);for(var x=0,M=t+1;x<M;){var z=x++;pe.addMulMutate(c[d][C],s[C][z],f[z])}}}return c},fe.curveDerivatives=function(e,t,n){var r=e.knots.length-e.degree-2;return fe.curveDerivativesGivenN(r,e,t,n)},fe.curveDerivativesGivenN=function(e,t,n,r){var i=t.degree,o=t.controlPoints,s=t.knots;if(!fe.areValidRelations(i,o.length,s.length))throw U.thrown("Invalid relations between control points, knot vector, and n");for(var a=o[0].length,t=r<i?r:i,u=pe.zeros2d(r+1,a),l=fe.knotSpanGivenN(e,i,n,s),h=fe.derivativeBasisFunctionsGivenNI(l,n,i,t,s),c=0,f=t+1;c<f;)for(var v=c++,_=0,d=i+1;_<d;){var g=_++;pe.addMulMutate(u[v],h[v][g],o[l-i+g])}return u},fe.curvePoint=function(e,t){var n=e.knots.length-e.degree-2;return fe.curvePointGivenN(n,e,t)},fe.areValidRelations=function(e,t,n){return t+e+1-n==0},fe.curvePointGivenN=function(e,t,n){var r=t.degree,i=t.controlPoints,t=t.knots;if(!fe.areValidRelations(r,i.length,t.length))throw U.thrown("Invalid relations between control points, knot Array, and n");for(var o=fe.knotSpanGivenN(e,r,n,t),s=fe.basisFunctionsGivenKnotSpanIndex(o,n,r,t),a=pe.zeros1d(i[0].length),u=0,l=r+1;u<l;){var h=u++;pe.addMulMutate(a,s[h],i[o-r+h])}return a},fe.volumePoint=function(e,t,n,r){var i=e.knotsU.length-e.degreeU-2,o=e.knotsV.length-e.degreeV-2,s=e.knotsW.length-e.degreeW-2;return fe.volumePointGivenNML(e,i,o,s,t,n,r)},fe.volumePointGivenNML=function(e,t,n,r,i,o,s){if(!fe.areValidRelations(e.degreeU,e.controlPoints.length,e.knotsU.length)||!fe.areValidRelations(e.degreeV,e.controlPoints[0].length,e.knotsV.length)||!fe.areValidRelations(e.degreeW,e.controlPoints[0][0].length,e.knotsW.length))throw U.thrown("Invalid relations between control points and knot vector");for(var a=e.controlPoints,u=e.degreeU,l=e.degreeV,h=e.degreeW,c=e.knotsU,f=e.knotsV,e=e.knotsW,v=a[0][0][0].length,t=fe.knotSpanGivenN(t,u,i,c),_=fe.knotSpanGivenN(n,l,o,f),d=fe.knotSpanGivenN(r,h,s,e),g=fe.basisFunctionsGivenKnotSpanIndex(t,i,u,c),p=fe.basisFunctionsGivenKnotSpanIndex(_,o,l,f),m=fe.basisFunctionsGivenKnotSpanIndex(d,s,h,e),b=t-u,w=pe.zeros1d(v),S=pe.zeros1d(v),y=pe.zeros1d(v),P=0,k=h+1;P<k;){for(var C=P++,y=pe.zeros1d(v),x=d-h+C,M=0,z=l+1;M<z;){for(var A=M++,S=pe.zeros1d(v),I=_-l+A,N=0,E=u+1;N<E;){var V=N++;pe.addMulMutate(S,g[V],a[b+V][I][x])}pe.addMulMutate(y,p[A],S)}pe.addMulMutate(w,m[C],y)}return w},fe.derivativeBasisFunctions=function(e,t,n){var r=fe.knotSpan(t,e,n),i=n.length-1-t-1;return fe.derivativeBasisFunctionsGivenNI(r,e,t,i,n)},fe.derivativeBasisFunctionsGivenNI=function(e,t,n,r,i){for(var o=pe.zeros2d(n+1,n+1),s=pe.zeros1d(n+1),a=pe.zeros1d(n+1),u=0,l=0,h=o[0][0]=1,c=n+1;h<c;){s[w=h++]=t-i[e+1-w],a[w]=i[e+w]-t;for(var f=u=0,v=w;f<v;){var _=f++;o[w][_]=a[_+1]+s[w-_],l=o[_][w-1]/o[w][_],o[_][w]=u+a[_+1]*l,u=s[w-_]*l}o[w][w]=u}for(var d=pe.zeros2d(r+1,n+1),g=pe.zeros2d(2,n+1),p=0,m=1,b=0,h=0,c=n+1;h<c;){var w=h++;d[0][w]=o[w][n]}for(h=0,c=n+1;h<c;){_=h++;m=1;for(f=g[p=0][0]=1,v=r+1;f<v;){var b=0,S=_-(x=f++),y=n-x;x<=_&&(g[m][0]=g[p][0]/o[1+y][S],b=g[m][0]*o[S][y]);for(var P=-1<=S?1:-S,k=(_-1<=y?x-1:n-_)+1;P<k;){w=P++;g[m][w]=(g[p][w]-g[p][w-1])/o[1+y][S+w],b+=g[m][w]*o[S+w][y]}_<=y&&(g[m][x]=-g[p][x-1]/o[1+y][_],b+=g[m][x]*o[_][y]),d[x][_]=b;l=p,p=m,m=l}}for(var C=n,h=1,c=r+1;h<c;){for(var x=h++,f=0,v=n+1;f<v;){w=f++;d[x][w]*=C}C*=n-x}return d},fe.basisFunctions=function(e,t,n){var r=fe.knotSpan(t,e,n);return fe.basisFunctionsGivenKnotSpanIndex(r,e,t,n)},fe.basisFunctionsGivenKnotSpanIndex=function(e,t,n,r){for(var i=pe.zeros1d(n+1),o=pe.zeros1d(n+1),s=pe.zeros1d(n+1),a=0,u=i[0]=1,l=n+1;u<l;){var h=u++;o[h]=t-r[e+1-h],s[h]=r[e+h]-t;for(var c=a=0,f=h;c<f;){var v=c++,_=i[v]/(s[1+v]+o[h-v]);i[v]=a+s[1+v]*_,a=o[h-v]*_}i[h]=a}return i},fe.knotSpan=function(e,t,n){return fe.knotSpanGivenN(n.length-e-2,e,t,n)},fe.knotSpanGivenN=function(e,t,n,r){if(n>r[e+1]-D.EPSILON)return e;if(n<r[t]+D.EPSILON)return t;for(var i=t,o=e+1,s=Math.floor((i+o)/2);n<r[s]||n>=r[s+1];)n<r[s]?o=s:i=s,s=Math.floor((i+o)/2);return s},fe.dehomogenize=function(e){for(var t=[],n=e[e.length-1],r=0,i=e.length-1;r<i;){var o=r++;t.push(e[o]/n)}return t},fe.rational1d=function(e){for(var t=e[0].length-1,n=new Array(e.length),r=0,i=e.length;r<i;){var o=r++;n[o]=e[o].slice(0,t)}return n},fe.rational2d=function(e){for(var t=fe.rational1d,n=new Array(e.length),r=0,i=e.length;r<i;){var o=r++;n[o]=t(e[o])}return n},fe.weight1d=function(e){for(var t=e[0].length-1,n=new Array(e.length),r=0,i=e.length;r<i;){var o=r++;n[o]=e[o][t]}return n},fe.weight2d=function(e){for(var t=fe.weight1d,n=new Array(e.length),r=0,i=e.length;r<i;){var o=r++;n[o]=t(e[o])}return n},fe.dehomogenize1d=function(e){for(var t=fe.dehomogenize,n=new Array(e.length),r=0,i=e.length;r<i;){var o=r++;n[o]=t(e[o])}return n},fe.dehomogenize2d=function(e){for(var t=fe.dehomogenize1d,n=new Array(e.length),r=0,i=e.length;r<i;){var o=r++;n[o]=t(e[o])}return n},fe.homogenize1d=function(e,t){for(var n=e.length,r=e[0].length,i=[],o=null!=t?t:pe.rep(e.length,1),s=0,a=n;s<a;){for(var u=s++,l=[],h=e[u],c=o[u],f=0,v=r;f<v;){var _=f++;l.push(h[_]*c)}l.push(c),i.push(l)}return i},fe.homogenize2d=function(e,t){var n,r=e.length,i=[];if(null!=t)n=t;else{for(var o=[],s=0,a=r;s<a;){var u=s++;o.push(pe.fill(e[0].length,1))}n=o}for(o=0,s=r;o<s;){u=o++;i.push(fe.homogenize1d(e[u],n[u]))}return i};var ve=e.eval.Intersect=function(){};(n["verb.eval.Intersect"]=ve).__name__="verb.eval.Intersect",ve.surfaces=function(e,t,n){for(var r=be.rationalSurfaceAdaptive(e),i=be.rationalSurfaceAdaptive(t),o=ve.meshes(r,i),s=new Array(o.length),a=0,u=o.length;a<u;){for(var l=o[d=a++],h=new Array(l.length),c=0,f=l.length;c<f;){var v=l[g=c++];h[g]=ve.surfacesAtPointWithEstimate(e,t,v.uv0,v.uv1,n)}s[d]=h}for(var _=s,s=new Array(_.length),a=0,u=_.length;a<u;){for(var d,g,p=_[d=a++],h=new Array(p.length),c=0,f=p.length;c<f;)h[g=c++]=p[g].point;s[d]=_e.rationalInterpCurve(h,3)}return s},ve.surfacesAtPointWithEstimate=function(e,t,n,r,i){for(var o,s,a,u=0;o=(l=fe.rationalSurfaceDerivatives(e,n[0],n[1],1))[0][0],d=l[1][0],g=l[0][1],v=pe.normalized(pe.cross(d,g)),s=pe.dot(v,o),f=(h=fe.rationalSurfaceDerivatives(t,r[0],r[1],1))[0][0],p=h[1][0],m=h[0][1],_=pe.normalized(pe.cross(p,m)),c=pe.dot(_,f),!((a=pe.distSquared(o,f))<i*i);){var l=pe.normalized(pe.cross(v,_)),h=pe.dot(l,o),c=ve.threePlanes(v,s,_,c,l,h);if(null==c)throw U.thrown("panic!");var l=pe.sub(c,o),h=pe.sub(c,f),c=pe.cross(d,v),f=pe.cross(g,v),v=pe.cross(p,_),_=pe.cross(m,_),d=pe.dot(f,l)/pe.dot(f,d),g=pe.dot(c,l)/pe.dot(c,g),p=pe.dot(_,h)/pe.dot(_,p),m=pe.dot(v,h)/pe.dot(v,m);if(n=pe.add([d,g],n),r=pe.add([p,m],r),!(++u<5))break}return new j(n,r,o,a)},ve.meshes=function(e,t,n,r){null==n&&(n=new J(e)),null==r&&(r=new J(t));for(var i=ve.boundingBoxTrees(n,r,0),o=new Array(i.length),s=0,a=i.length;s<a;){var u=s++,l=i[u];o[u]=ve.triangles(e,l.item0,t,l.item1)}for(var s=[],a=0,h=o;a<h.length;){var c=h[a];++a,null!=c&&s.push(c)}for(var a=[],h=0,f=s;h<f.length;){c=f[h];++h,pe.distSquared(c.min.point,c.max.point)>D.EPSILON&&a.push(c)}r=L.unique(a,function(e,t){var n=pe.sub(e.min.uv0,t.min.uv0),r=pe.dot(n,n),i=pe.sub(e.max.uv0,t.max.uv0),n=pe.dot(i,i),i=pe.sub(e.min.uv0,t.max.uv0),i=pe.dot(i,i),t=pe.sub(e.max.uv0,t.min.uv0),t=pe.dot(t,t);return r<D.EPSILON&&n<D.EPSILON||i<D.EPSILON&&t<D.EPSILON});return ve.makeMeshIntersectionPolylines(r)},ve.meshSlices=function(e,t,n,r){for(var i=new re(e),o=i.boundingBox(),s=o.min[0],a=o.min[1],u=o.max[0],l=o.max[1],h=pe.span(t,n,r),c=[],f=0;f<h.length;){var v=h[f];++f;v=new y([[0,1,2],[0,2,3]],[[s,a,v],[u,a,v],[u,l,v],[s,l,v]],null,[[0,0],[1,0],[1,1],[0,1]]);c.push(ve.meshes(e,v,i))}return c},ve.makeMeshIntersectionPolylines=function(e){if(0==e.length)return[];for(var t=0;t<e.length;){var n=e[t];++t,n.max.opp=n.min,n.min.opp=n.max}for(var r=ve.kdTreeFromSegments(e),i=[],t=0;t<e.length;){var o=e[t];++t,i.push(o.min),i.push(o.max)}for(t=0;t<i.length;){var s,a=i[t];++t,null!=a.adj||null!=(s=ve.lookupAdjacentSegment(a,r,e.length))&&null==s.adj&&((a.adj=s).adj=a)}for(var t=[],u=0,l=i;u<l.length;){var h=l[u];++u,null==h.adj&&t.push(h)}var c=t;0==c.length&&(c=i);for(var f=[],v=0,_=!1;0!=c.length;){var d,g=c.pop();if(!g.visited){for(var p=[],m=g;null!=m&&!m.visited&&(m.visited=!0,m.opp.visited=!0,p.push(m),v+=2,(m=m.opp.adj)!=g););0<p.length&&(p.push(p[p.length-1].opp),f.push(p))}0==c.length&&0<i.length&&(_||v<i.length)&&(_=!0,d=i.pop(),c.push(d))}return f},ve.kdTreeFromSegments=function(e){for(var t=[],n=0;n<e.length;){var r=e[n];++n,t.push(new Z(r.min.point,r.min)),t.push(new Z(r.max.point,r.max))}return new W(t,pe.distSquared)},ve.lookupAdjacentSegment=function(e,t,n){for(var r=[],i=0,o=t.nearest(e.point,n,D.EPSILON);i<o.length;){var s=o[i];++i,e!=s.item0.obj&&r.push(s)}for(var a=r,u=new Array(a.length),r=0,i=a.length;r<i;){var l=r++;u[l]=a[l].item0.obj}return 1==u.length?u[0]:null},ve.curveAndSurface=function(e,t,n,r,i){null==n&&(n=.001),null==r&&(r=new Y(e)),null==i&&(i=new $(t));for(var o=ve.boundingBoxTrees(r,i,n),s=new Array(o.length),a=0,u=o.length;a<u;){var l=a++,h=o[l],c=h.item0,f=h.item1,v=(L.first(c.knots)+L.last(c.knots))/2,h=[(L.first(f.knotsU)+L.last(f.knotsU))/2,(L.first(f.knotsV)+L.last(f.knotsV))/2];s[l]=ve.curveAndSurfaceWithEstimate(c,f,[v].concat(h),n)}for(var a=[],u=0,_=s;u<_.length;){var d=_[u];++u,pe.distSquared(d.curvePoint,d.surfacePoint)<n*n&&a.push(d)}return L.unique(a,function(e,t){return Math.abs(e.u-t.u)<.5*n})},ve.curveAndSurfaceWithEstimate=function(i,o,e,t){null==t&&(t=.001);t=ie.uncmin(function(e){var t=fe.rationalCurvePoint(i,e[0]),e=fe.rationalSurfacePoint(o,e[1],e[2]),e=pe.sub(t,e);return pe.dot(e,e)},e,t*t,function(e){var t=fe.rationalCurveDerivatives(i,e[0],1),n=fe.rationalSurfaceDerivatives(o,e[1],e[2],1),r=pe.sub(n[0][0],t[0]),e=pe.mul(-1,t[1]),t=n[1][0],n=n[0][1];return[2*pe.dot(e,r),2*pe.dot(t,r),2*pe.dot(n,r)]}).solution;return new b(t[0],[t[1],t[2]],fe.rationalCurvePoint(i,t[0]),fe.rationalSurfacePoint(o,t[1],t[2]))},ve.polylineAndMesh=function(e,t,n){for(var r=ve.boundingBoxTrees(new Q(e),new J(t),n),i=[],o=0;o<r.length;){var s=r[o];++o;var a,u=s.item0,l=s.item1,h=ve.segmentWithTriangle(e.points[u],e.points[u+1],t.points,t.faces[l]);null!=h&&(a=h.point,s=pe.lerp(h.p,[e.params[u]],[e.params[u+1]])[0],h=ne.triangleUVFromPoint(t,l,a),i.push(new F(a,s,h,u,l)))}return i},ve.boundingBoxTrees=function(e,t,n){null==n&&(n=1e-9);var r=[],i=[];r.push(e),i.push(t);for(var o=[];0<r.length;){var s,a,u=r.pop(),l=i.pop();u.empty()||l.empty()||u.boundingBox().intersects(l.boundingBox(),n)&&(e=u.indivisible(n),t=l.indivisible(n),e&&t?o.push(new p(u.yield(),l.yield())):!e||t?e||!t?(s=u.split(),a=l.split(),r.push(s.item1),i.push(a.item1),r.push(s.item1),i.push(a.item0),r.push(s.item0),i.push(a.item1),r.push(s.item0),i.push(a.item0)):(a=u.split(),r.push(a.item1),i.push(l),r.push(a.item0),i.push(l)):(l=l.split(),r.push(u),i.push(l.item1),r.push(u),i.push(l.item0)))}return o},ve.curves=function(e,t,n){for(var r=ve.boundingBoxTrees(new Y(e),new Y(t),0),i=new Array(r.length),o=0,s=r.length;o<s;){var a=o++,u=r[a];i[a]=ve.curvesWithEstimate(e,t,L.first(u.item0.knots),L.first(u.item1.knots),n)}for(var o=[],s=0,l=i;s<l.length;){var h=l[s];++s,pe.distSquared(h.point0,h.point1)<n&&o.push(h)}return L.unique(o,function(e,t){return Math.abs(e.u0-t.u0)<5*n})},ve.curvesWithEstimate=function(r,i,e,t,n){var o=ie.uncmin(function(e){var t=fe.rationalCurvePoint(r,e[0]),e=fe.rationalCurvePoint(i,e[1]),e=pe.sub(t,e);return pe.dot(e,e)},[e,t],n*n,function(e){var t=fe.rationalCurveDerivatives(r,e[0],1),n=fe.rationalCurveDerivatives(i,e[1],1),e=pe.sub(t[0],n[0]),t=t[1],n=pe.mul(-1,n[1]);return[2*pe.dot(t,e),2*pe.dot(n,e)]}),t=o.solution[0],e=o.solution[1],n=fe.rationalCurvePoint(r,t),o=fe.rationalCurvePoint(i,e);return new m(n,o,t,e)},ve.triangles=function(e,t,n,r){var i=e.faces[t],o=n.faces[r],s=ne.getTriangleNorm(e.points,i),a=ne.getTriangleNorm(n.points,o),i=e.points[i[0]],o=n.points[o[0]],o=ve.planes(i,s,o,a);if(null==o)return null;a=ve.clipRayInCoplanarTriangle(o,e,t);if(null==a)return null;o=ve.clipRayInCoplanarTriangle(o,n,r);if(null==o)return null;n=ve.mergeTriangleClipIntervals(a,o,e,t,n,r);return null==n?null:new S(new R(n.min.uv0,n.min.uv1,n.min.point,t,r),new R(n.max.uv0,n.max.uv1,n.max.point,t,r))},ve.clipRayInCoplanarTriangle=function(e,t,n){for(var n=t.faces[n],r=[t.points[n[0]],t.points[n[1]],t.points[n[2]]],i=[t.uvs[n[0]],t.uvs[n[1]],t.uvs[n[2]]],o=[pe.sub(i[1],i[0]),pe.sub(i[2],i[1]),pe.sub(i[0],i[2])],s=[pe.sub(r[1],r[0]),pe.sub(r[2],r[1]),pe.sub(r[0],r[2])],a=pe.normalized,u=new Array(s.length),l=0,h=s.length;l<h;)u[d=l++]=a(s[d]);for(var c=u,a=pe.norm,u=new Array(s.length),l=0,h=s.length;l<h;)u[d=l++]=a(s[d]);for(var f=u,v=null,_=null,l=0;l<3;){var d,g=r[d=l++],p=c[d],g=ve.rays(g,p,e.origin,e.dir);null!=g&&(p=g.u0,g=g.u1,p<-D.EPSILON||p>f[d]+D.EPSILON||((null==v||g<v.u)&&(v=new K(g,pe.onRay(e.origin,e.dir,g),pe.onRay(i[d],o[d],p/f[d]))),(null==_||g>_.u)&&(_=new K(g,pe.onRay(e.origin,e.dir,g),pe.onRay(i[d],o[d],p/f[d])))))}return null==_||null==v?null:new S(v,_)},ve.mergeTriangleClipIntervals=function(e,t,n,r,i,o){if(t.min.u>e.max.u+D.EPSILON||e.min.u>t.max.u+D.EPSILON)return null;var s=e.min.u>t.min.u?new p(e.min,0):new p(t.min,1),e=e.max.u<t.max.u?new p(e.max,0):new p(t.max,1),t=new S(new R(null,null,s.item0.point,r,o),new R(null,null,e.item0.point,r,o));return 0==s.item1?(t.min.uv0=s.item0.uv,t.min.uv1=ne.triangleUVFromPoint(i,o,s.item0.point)):(t.min.uv0=ne.triangleUVFromPoint(n,r,s.item0.point),t.min.uv1=s.item0.uv),0==e.item1?(t.max.uv0=e.item0.uv,t.max.uv1=ne.triangleUVFromPoint(i,o,e.item0.point)):(t.max.uv0=ne.triangleUVFromPoint(n,r,e.item0.point),t.max.uv1=e.item0.uv),t},ve.planes=function(e,t,n,r){var i=pe.cross(t,r);if(pe.dot(i,i)<D.EPSILON)return null;var o,s,a,u=0,l=Math.abs(i[0]),h=Math.abs(i[1]),c=Math.abs(i[2]);l<h&&(u=1,l=h),l<c&&(u=2,l=c),l=0==u?(o=t[1],s=t[2],a=r[1],r[2]):1==u?(o=t[0],s=t[2],a=r[0],r[2]):(o=t[0],s=t[1],a=r[0],r[1]);t=-pe.dot(e,t),n=-pe.dot(n,r),r=o*l-s*a,l=(s*n-t*l)/r,r=(t*a-o*n)/r,r=0==u?[0,l,r]:1==u?[l,0,r]:[l,r,0];return new g(r,pe.normalized(i))},ve.threePlanes=function(e,t,n,r,i,o){var s=pe.cross(n,i),a=pe.dot(e,s);if(Math.abs(a)<D.EPSILON)return null;i=pe.sub(pe.mul(o,n),pe.mul(r,i)),i=pe.add(pe.mul(t,s),pe.cross(e,i));return pe.mul(1/a,i)},ve.polylines=function(e,t,n){for(var r=ve.boundingBoxTrees(new Q(e),new Q(t),n),i=[],o=0;o<r.length;){var s=r[o];++o;var a=s.item0,u=s.item1,s=ve.segments(e.points[a],e.points[a+1],t.points[u],t.points[u+1],n);null!=s&&(s.u0=pe.lerp(s.u0,[e.params[a]],[e.params[a+1]])[0],s.u1=pe.lerp(s.u1,[t.params[u]],[t.params[u+1]])[0],i.push(s))}return i},ve.segments=function(e,t,n,r,i){var o=pe.sub(t,e),s=Math.sqrt(pe.dot(o,o)),a=pe.mul(1/s,o),u=pe.sub(r,n),t=Math.sqrt(pe.dot(u,u)),r=pe.mul(1/t,u),r=ve.rays(e,a,n,r);if(null!=r){s=Math.min(Math.max(0,r.u0/s),1),t=Math.min(Math.max(0,r.u1/t),1),o=pe.onRay(e,o,s),u=pe.onRay(n,u,t);if(pe.distSquared(o,u)<i*i)return new m(o,u,s,t)}return null},ve.rays=function(e,t,n,r){var i=pe.dot(t,r),o=pe.dot(t,n),s=pe.dot(t,e),a=pe.dot(r,n),u=pe.dot(r,e),l=pe.dot(t,t),h=l*pe.dot(r,r)-i*i;if(Math.abs(h)<D.EPSILON)return null;h=(i*(o-s)-l*(a-u))/h,l=(o-s+h*i)/l,t=pe.onRay(e,t,l),r=pe.onRay(n,r,h);return new m(t,r,l,h)},ve.segmentWithTriangle=function(e,t,n,r){var i=n[r[0]],o=n[r[1]],s=n[r[2]],a=pe.sub(o,i),n=pe.sub(s,i),r=pe.cross(a,n),o=pe.sub(t,e),s=pe.sub(e,i),t=-pe.dot(r,s),s=pe.dot(r,o);if(Math.abs(s)<D.EPSILON)return null;r=t/s;if(r<0||1<r)return null;t=pe.add(e,pe.mul(r,o)),s=pe.dot(a,n),e=pe.dot(a,a),o=pe.dot(n,n),i=pe.sub(t,i),a=pe.dot(i,a),i=pe.dot(i,n),n=s*s-e*o;if(Math.abs(n)<D.EPSILON)return null;o=(s*i-o*a)/n,n=(s*a-e*i)/n;return o>1+D.EPSILON||n>1+D.EPSILON||n<-D.EPSILON||o<-D.EPSILON||o+n>1+D.EPSILON?null:new G(t,o,n,r)},ve.segmentAndPlane=function(e,t,n,r){t=pe.dot(r,pe.sub(t,e));if(Math.abs(t)<D.EPSILON)return null;t=pe.dot(r,pe.sub(n,e))/t;return t>1+D.EPSILON||t<-D.EPSILON?null:{p:t}};var _e=e.eval.Make=function(){};(n["verb.eval.Make"]=_e).__name__="verb.eval.Make",_e.rationalTranslationalSurface=function(e,t){for(var n=fe.rationalCurvePoint(t,L.first(t.knots)),r=L.first(t.knots),i=L.last(t.knots),o=2*t.controlPoints.length,s=(i-r)/(o-1),a=[],u=0,l=o;u<l;){var h=u++,h=pe.sub(fe.rationalCurvePoint(t,r+h*s),n),h=me.rationalCurveTransform(e,[[1,0,0,h[0]],[0,1,0,h[1]],[0,0,1,h[2]],[0,0,0,1]]);a.push(h)}return _e.loftedSurface(a)},_e.surfaceBoundaryCurves=function(e){return[_e.surfaceIsocurve(e,L.first(e.knotsU),!1),_e.surfaceIsocurve(e,L.last(e.knotsU),!1),_e.surfaceIsocurve(e,L.first(e.knotsV),!0),_e.surfaceIsocurve(e,L.last(e.knotsV),!0)]},_e.surfaceIsocurve=function(e,t,n){null==n&&(n=!1);for(var r=n?e.knotsV:e.knotsU,i=n?e.degreeV:e.degreeU,o=ae.knotMultiplicities(r),s=-1,a=0,u=o.length;a<u;){var l=a++;if(Math.abs(t-o[l].knot)<D.EPSILON){s=l;break}}var h=i+1;0<=s&&(h-=o[s].mult);var e=0<h?me.surfaceKnotRefine(e,pe.rep(h,t),n):e,c=fe.knotSpan(i,t,r);if(Math.abs(t-L.first(r))<D.EPSILON?c=0:Math.abs(t-L.last(r))<D.EPSILON&&(c=(n?e.controlPoints[0]:e.controlPoints).length-1),n){for(var r=e.degreeU,n=e.knotsU,a=[],u=0,f=e.controlPoints;u<f.length;){var v=f[u];++u,a.push(v[c])}return new ge(r,n,a)}return new ge(e.degreeV,e.knotsV,e.controlPoints[c])},_e.loftedSurface=function(e,t){var n=(e=me.unifyCurveKnotVectors(e))[0].degree;null==t&&(t=3),t>e.length-1&&(t=e.length-1);for(var r=e[0].knots,i=[],o=[],s=0,a=e[0].controlPoints.length;s<a;){for(var u=s++,l=new Array(e.length),h=0,c=e.length;h<c;){var f=h++;l[f]=e[f].controlPoints[u]}var v=_e.rationalInterpCurve(l,t,!0);o.push(v.controlPoints),i=v.knots}return new O(n,t,r,i,o)},_e.clonedCurve=function(e){for(var t=e.degree,n=e.knots.slice(),r=e.controlPoints,i=new Array(r.length),o=0,s=r.length;o<s;){var a=o++;i[a]=r[a].slice()}return new ge(t,n,i)},_e.rationalBezierCurve=function(e,t){for(var n=e.length-1,r=[],i=0,o=1+n;i<o;){i++;r.push(0)}for(i=0,o=1+n;i<o;){i++;r.push(1)}return null==t&&(t=pe.rep(e.length,1)),new ge(n,r,fe.homogenize1d(e,t))},_e.fourPointSurface=function(e,t,n,r,i){null==i&&(i=3);for(var o=i,s=[],a=0,u=i+1;a<u;){for(var l=a++,h=[],c=0,f=i+1;c<f;){var v=c++,_=1-l/o,d=pe.lerp(_,e,t),_=pe.lerp(_,r,n),_=pe.lerp(1-v/o,d,_);_.push(1),h.push(_)}s.push(h)}var g=pe.rep(i+1,0),p=pe.rep(i+1,1);return new O(i,i,g.concat(p),g.concat(p),s)},_e.ellipseArc=function(e,t,n,r,i){var o=pe.norm(t),s=pe.norm(n);t=pe.normalized(t),n=pe.normalized(n),i<r&&(i=2*Math.PI+r);var i=i-r,a=0,u=i/(a=i<=Math.PI/2?1:i<=Math.PI?2:i<=3*Math.PI/2?3:4),l=Math.cos(u/2),h=pe.add(e,pe.add(pe.mul(o*Math.cos(r),t),pe.mul(s*Math.sin(r),n))),c=pe.sub(pe.mul(Math.cos(r),n),pe.mul(Math.sin(r),t)),f=[],v=pe.zeros1d(2*a+3),_=0,d=r,g=pe.zeros1d(2*a);f[0]=h;for(var p=g[0]=1,m=a+1;p<m;){var b=p++;d+=u;var w=pe.add(e,pe.add(pe.mul(o*Math.cos(d),t),pe.mul(s*Math.sin(d),n)));g[_+2]=1,f[_+2]=w;var S=pe.sub(pe.mul(Math.cos(d),n),pe.mul(Math.sin(d),t)),y=ve.rays(h,pe.mul(1/pe.norm(c),c),w,pe.mul(1/pe.norm(S),S)),y=pe.add(h,pe.mul(y.u0,c));g[_+1]=l,f[_+1]=y,_+=2,b<a&&(h=w,c=S)}r=2*a+1;switch(v[0]=0,v[r]=1,v[1]=0,v[1+r]=1,v[2]=0,v[2+r]=1,a){case 2:v[3]=v[4]=.5;break;case 3:v[3]=v[4]=.3333333333333333,v[5]=v[6]=.6666666666666666;break;case 4:v[3]=v[4]=.25,v[5]=v[6]=.5,v[7]=v[8]=.75}return new ge(2,v,fe.homogenize1d(f,g))},_e.arc=function(e,t,n,r,i,o){return _e.ellipseArc(e,pe.mul(r,pe.normalized(t)),pe.mul(r,pe.normalized(n)),i,o)},_e.polyline=function(e){for(var t=[0,0],n=0,r=0,i=e.length-1;r<i;){var o=r++;n+=pe.dist(e[o],e[o+1]),t.push(n)}t.push(n),t=pe.mul(1/n,t);for(var r=[],i=0,s=e.length;i<s;){o=i++;r.push(1)}var a=r;return new ge(1,t,fe.homogenize1d(e.slice(0),a))},_e.extrudedSurface=function(e,t,n){for(var r=[[],[],[]],i=[[],[],[]],o=fe.dehomogenize1d(n.controlPoints),s=fe.weight1d(n.controlPoints),a=pe.mul(t,e),u=pe.mul(.5*t,e),l=0,h=o.length;l<h;){var c=l++;r[2][c]=o[c],r[1][c]=pe.add(u,o[c]),r[0][c]=pe.add(a,o[c]),i[0][c]=s[c],i[1][c]=s[c],i[2][c]=s[c]}return new O(2,n.degree,[0,0,0,1,1,1],n.knots,fe.homogenize2d(r,i))},_e.cylindricalSurface=function(e,t,n,r,i){var o=pe.cross(e,t),i=(Math.PI,_e.arc(n,t,o,i,0,2*Math.PI));return _e.extrudedSurface(e,r,i)},_e.revolvedSurface=function(e,t,n,r){var i,o,s=fe.dehomogenize1d(e.controlPoints),a=fe.weight1d(e.controlPoints);r<=Math.PI/2?(i=1,o=pe.zeros1d(6+2*(i-1))):r<=Math.PI?(i=2,(o=pe.zeros1d(6+2*(i-1)))[3]=o[4]=.5):r<=3*Math.PI/2?(i=3,(o=pe.zeros1d(6+2*(i-1)))[3]=o[4]=.3333333333333333,o[5]=o[6]=.6666666666666666):(i=4,(o=pe.zeros1d(6+2*(i-1)))[3]=o[4]=.25,o[5]=o[6]=.5,o[7]=o[8]=.75);var u=r/i,l=3+2*(i-1);o[0]=0,o[l]=1,o[1]=0,o[1+l]=1,o[2]=0,o[2+l]=1;for(var h=Math.cos(u/2),c=0,f=pe.zeros1d(i+1),v=pe.zeros1d(i+1),_=pe.zeros3d(2*i+1,s.length,3),d=pe.zeros2d(2*i+1,s.length),g=1,p=i+1;g<p;)c+=u,v[M=g++]=Math.cos(c),f[M]=Math.sin(c);for(g=0,p=s.length;g<p;){var l=g++,m=se.rayClosestPoint(s[l],t,n),b=pe.sub(s[l],m),w=pe.norm(b),S=pe.cross(n,b);w>D.EPSILON&&(b=pe.mul(1/w,b),S=pe.mul(1/w,S)),_[0][l]=s[l];var y=s[l];d[0][l]=a[l];for(var P=S,k=0,c=0,C=1,x=i+1;C<x;){var M=C++,z=0==w?m:pe.add(m,pe.add(pe.mul(w*v[M],b),pe.mul(w*f[M],S)));_[k+2][l]=z,d[k+2][l]=a[l];var A,I=pe.sub(pe.mul(v[M],S),pe.mul(f[M],b));0==w?_[k+1][l]=m:(A=ve.rays(y,pe.mul(1/pe.norm(P),P),z,pe.mul(1/pe.norm(I),I)),A=pe.add(y,pe.mul(A.u0,P)),_[k+1][l]=A),d[k+1][l]=h*a[l],k+=2,M<i&&(y=z,P=I)}}return new O(2,e.degree,o,e.knots,fe.homogenize2d(_,d))},_e.sphericalSurface=function(e,t,n,r){r=_e.arc(e,pe.mul(-1,t),n,r,0,Math.PI);return _e.revolvedSurface(r,e,t,2*Math.PI)},_e.conicalSurface=function(e,t,n,r,i){var o=2*Math.PI,t=[pe.add(n,pe.mul(r,e)),pe.add(n,pe.mul(i,t))],t=new ge(1,[0,0,1,1],fe.homogenize1d(t,[1,1]));return _e.revolvedSurface(t,n,e,o)},_e.rationalInterpCurve=function(e,t,n,r,i){if(null==n&&(n=!1),null==t&&(t=3),e.length<t+1)throw U.thrown("You need to supply at least degree + 1 points! You only supplied "+e.length+" points.");for(var o=[0],s=1,a=e.length;s<a;){var u=s++,l=pe.norm(pe.sub(e[u],e[u-1])),h=o[o.length-1];o.push(h+l)}for(var c=o[o.length-1],s=0,a=o.length;s<a;)o[u=s++]/=c;for(var f=pe.rep(t+1,0),v=null!=r&&null!=i,s=v?0:1,a=v?o.length-t+1:o.length-t;s<a;){for(var u=s++,_=0,d=0,g=t;d<g;)_+=o[u+(E=d++)];f.push(1/t*_)}for(var p,m=f.concat(pe.rep(t+1,1)),b=[],w=v?e.length+1:e.length-1,S=v?e.length-(t-1):e.length-(t+1),s=0;s<o.length;){var y=o[s];++s;var P=fe.knotSpanGivenN(w,t,y,m),k=fe.basisFunctionsGivenKnotSpanIndex(P,y,t,m),y=P-t,P=pe.zeros1d(y),y=pe.zeros1d(S-y);b.push(P.concat(k).concat(y))}v&&(C=b[0].length-2,p=[-1,1].concat(pe.zeros1d(C)),C=pe.zeros1d(C).concat([-1,1]),L.spliceAndInsert(b,1,0,p),L.spliceAndInsert(b,b.length-1,0,C));for(var C=e[0].length,x=[],M=(1-m[m.length-t-2])/t,z=m[t+1]/t,s=0,a=C;s<a;){var A,u=s++;if(v){(A=[e[0][u]]).push(z*r[u]);for(var I=1,N=e.length-1;I<N;){var E=I++;A.push(e[E][u])}A.push(M*i[u]),A.push(L.last(e)[u])}else{for(var V=new Array(e.length),d=0,g=e.length;d<g;){var T=d++;V[T]=e[T][u]}A=V}var B=ee.solve(b,A);x.push(B)}C=ee.transpose(x);return n||(n=pe.rep(C.length,1),C=fe.homogenize1d(C,n)),new ge(t,m,C)};var me=e.eval.Modify=function(){};(n["verb.eval.Modify"]=me).__name__="verb.eval.Modify",me.curveReverse=function(e){return new ge(e.degree,me.knotsReverse(e.knots),L.reversed(e.controlPoints))},me.surfaceReverse=function(e,t){if(null==t&&(t=!1),t){for(var n=e.degreeU,r=e.degreeV,i=e.knotsU,t=me.knotsReverse(e.knotsV),o=[],s=0,a=e.controlPoints;s<a.length;){var u=a[s];++s,o.push(L.reversed(u))}return new O(n,r,i,t,o)}return new O(e.degreeU,e.degreeV,me.knotsReverse(e.knotsU),e.knotsV,L.reversed(e.controlPoints))},me.knotsReverse=function(e){for(var t=L.first(e),n=(L.last(e),[t]),r=e.length,i=1,o=r;i<o;){var s=i++;n.push(n[s-1]+(e[r-s]-e[r-s-1]))}return n},me.unifyCurveKnotVectors=function(e){for(var t=_e.clonedCurve,n=new Array(e.length),r=0,i=e.length;r<i;)n[m=r++]=t(e[m]);for(var o=w.fold(e=n,function(e,t){return me.imax(e.degree,t)},0),r=0,i=e.length;r<i;)e[m=r++].degree<o&&(e[m]=me.curveElevateDegree(e[m],o));for(r=[],i=0;i<e.length;){var s=e[i];++i,r.push(new S(L.first(s.knots),L.last(s.knots)))}for(var a=r,r=0,i=e.length;r<i;){for(var u=a[m=r++].min,l=e[m].knots,n=new Array(l.length),h=0,c=l.length;h<c;)n[d=h++]=l[d]-u;e[m].knots=n}for(n=new Array(a.length),r=0,i=a.length;r<i;){var f=a[m=r++];n[m]=f.max-f.min}for(var v=n,_=w.fold(v,function(e,t){return Math.max(e,t)},0),r=0,i=e.length;r<i;){for(var d,g=_/v[m=r++],l=e[m].knots,n=new Array(l.length),h=0,c=l.length;h<c;)n[d=h++]=l[d]*g;e[m].knots=n}for(var p=w.fold(e,function(e,t){return pe.sortedSetUnion(e.knots,t)},[]),r=0,i=e.length;r<i;){var m=r++,b=pe.sortedSetSub(p,e[m].knots);0==b.length&&(e[m]=e[m]),e[m]=me.curveKnotRefine(e[m],b)}return e},me.imin=function(e,t){return e<t?e:t},me.imax=function(e,t){return t<e?e:t},me.curveElevateDegree=function(e,t){if(t<=e.degree)return e;var n=e.knots.length-e.degree-2,r=e.degree,i=e.knots,o=e.controlPoints,s=t-e.degree,a=e.controlPoints[0].length,u=pe.zeros2d(r+s+1,r+1),l=[],h=[],c=[],f=n+r+1,v=t,n=Math.floor(v/2),_=[],d=[];u[0][0]=1;for(var g=u[v][r]=1,p=n+1;g<p;)for(var m=g++,b=1/de.get(v,m),w=me.imin(r,m),S=me.imax(0,m-s),y=w+1;S<y;){var P=S++;u[m][P]=b*de.get(r,P)*de.get(s,m-P)}for(g=n+1,p=v;g<p;)for(m=g++,w=me.imin(r,m),S=me.imax(0,m-s),y=w+1;S<y;){P=S++;u[m][P]=u[v-m][r-P]}var k=v+1,C=-1,x=r,M=r+1,z=1,A=i[0];_[0]=o[0];for(g=0,p=v+1;g<p;)d[m=g++]=A;for(g=0,p=r+1;g<p;)l[m=g++]=o[m];for(;M<f;){for(m=M;M<f&&i[M]==i[M+1];)++M;var I=M-m+1,N=i[M],E=C,C=r-I,V=0<E?Math.floor((E+2)/2):1,T=0<C?Math.floor(v-(C+1)/2):v;if(0<C){for(var B=N-A,U=[],L=r;I<L;)U[L-I-1]=B/(i[x+L]-A),--L;for(g=1,p=C+1;g<p;){for(var D=C-(P=g++),O=I+P,R=r;O<=R;)l[R]=pe.add(pe.mul(U[R-O],l[R]),pe.mul(1-U[R-O],l[R-1])),--R;c[D]=l[r]}}for(S=V,y=v+1;S<y;){var F=S++;h[F]=pe.zeros1d(a);for(var w=me.imin(r,F),j=me.imax(0,F-s),G=w+1;j<G;){var K=j++;h[F]=pe.add(h[F],pe.mul(u[F][K],l[K]))}}if(1<E)for(var q=k-2,W=k,H=N-A,Z=(N-d[k-1])/H,X=1,Y=E;X<Y;){for(var J,Q=X++,$=q,ee=W,te=ee-k+1;Q<ee-$;)$<z&&(J=(N-d[$])/(A-d[$]),_[$]=pe.lerp(J,_[$],_[$-1])),V<=ee?ee-Q<=k-v+E&&(J=(N-d[ee-Q])/H,h[te]=pe.lerp(J,h[te],h[te+1])):h[te]=pe.lerp(Z,h[te],h[te+1]),++$,--ee,--te;--q,++W}if(x!=r)for(var ne=0,re=v-E;ne<re;){ne++;d[k]=A,++k}for(var ie=V,oe=T+1;ie<oe;){var se=ie++;_[z]=h[se],++z}if(M<f){for(var ae=0,ue=C;ae<ue;){var le=ae++;l[le]=c[le]}for(var he=C,ce=r+1;he<ce;){var fe=he++;l[fe]=o[M-r+fe]}x=M,++M,A=N}else for(var ve=0,_e=v+1;ve<_e;)d[k+ve++]=N}return new ge(t,d,_)},me.rationalSurfaceTransform=function(e,t){for(var n=fe.dehomogenize2d(e.controlPoints),r=0,i=n.length;r<i;)for(var o=r++,s=0,a=n[o].length;s<a;){var u=s++,l=n[o][u];l.push(1),n[o][u]=ee.dot(t,l).slice(0,l.length-1)}return new O(e.degreeU,e.degreeV,e.knotsU.slice(),e.knotsV.slice(),fe.homogenize2d(n,fe.weight2d(e.controlPoints)))},me.rationalCurveTransform=function(e,t){for(var n=fe.dehomogenize1d(e.controlPoints),r=0,i=n.length;r<i;){var o=r++,s=n[o];s.push(1),n[o]=ee.dot(t,s).slice(0,s.length-1)}return new ge(e.degree,e.knots.slice(),fe.homogenize1d(n,fe.weight1d(e.controlPoints)))},me.surfaceKnotRefine=function(e,t,n){for(var r,i,o=[],s=n?(i=e.controlPoints,r=e.knotsV,e.degreeV):(i=ee.transpose(e.controlPoints),r=e.knotsU,e.degreeU),a=null,u=0;u<i.length;){var l=i[u];++u,a=me.curveKnotRefine(new ge(s,r,l),t),o.push(a.controlPoints)}var h=a.knots;return n?new O(e.degreeU,e.degreeV,e.knotsU.slice(),h,o):(o=ee.transpose(o),new O(e.degreeU,e.degreeV,h,e.knotsV.slice(),o))},me.decomposeCurveIntoBeziers=function(e){for(var t=e.degree,n=e.controlPoints,r=e.knots,i=ae.knotMultiplicities(r),o=t+1,s=0;s<i.length;){var a=i[s];++s,a.mult<o&&(a=pe.rep(o-a.mult,a.knot),r=(a=me.curveKnotRefine(new ge(t,r,n),a)).knots,n=a.controlPoints)}r.length;for(var u=2*o,l=[],h=0;h<n.length;){var c=r.slice(h,h+u),f=n.slice(h,h+o);l.push(new ge(t,c,f)),h+=o}return l},me.curveKnotRefine=function(e,t){if(0==t.length)return _e.clonedCurve(e);for(var n=e.degree,r=e.controlPoints,i=e.knots,o=r.length-1,s=o+n+1,a=t.length-1,u=fe.knotSpan(n,t[0],i),e=fe.knotSpan(n,t[a],i),l=[],h=[],c=0,f=u-n+1;c<f;)l[v=c++]=r[v];for(c=e-1,f=1+o;c<f;)l[(v=c++)+a+1]=r[v];for(c=0,f=u+1;c<f;)h[v=c++]=i[v];for(c=e+n,f=s+1;c<f;)h[(v=c++)+a+1]=i[v];for(var v=e+n-1,_=e+n+a,d=a;0<=d;){for(;t[d]<=i[v]&&u<v;)l[_-n-1]=r[v-n-1],h[_]=i[v],--_,--v;l[_-n-1]=l[_-n];for(c=1,f=n+1;c<f;){var g=c++,p=_-n+g,m=h[_+g]-t[d];Math.abs(m)<D.EPSILON?l[p-1]=l[p]:(m/=h[_+g]-i[v-n+g],l[p-1]=pe.add(pe.mul(m,l[p-1]),pe.mul(1-m,l[p])))}h[_]=t[d],--_,--d}return new ge(n,h,l)},me.curveKnotInsert=function(e,t,n){for(var r=e.degree,i=e.controlPoints,o=e.knots,e=i.length,s=fe.knotSpan(r,t,o),a=[],u=[],l=[],h=0,c=1,f=s+1;c<f;)u[h=c++]=o[h];for(c=1,f=n+1;c<f;)u[s+(h=c++)]=t;for(c=s+1,f=o.length;c<f;)u[(h=c++)+n]=o[h];for(c=0,f=s-r+1;c<f;)l[h=c++]=i[h];for(c=+s,f=e;c<f;)l[(h=c++)+n]=i[h];for(c=0,f=+r+1;c<f;)a[h=c++]=i[s-r+h];for(var v=0,c=1,f=n+1;c<f;){for(var _=c++,v=s-r+_,d=0,g=r-_+1;d<g;){var p=(t-o[v+(h=d++)])/(o[h+s+1]-o[v+h]);a[h]=pe.add(pe.mul(p,a[h+1]),pe.mul(1-p,a[h]))}l[v]=a[0],l[s+n-_]=a[r-_]}for(c=v+1,f=+s;c<f;)l[h=c++]=a[h-v];return new ge(r,u,l)};var be=e.eval.Tess=function(){};(n["verb.eval.Tess"]=be).__name__="verb.eval.Tess",be.rationalCurveRegularSample=function(e,t,n){return be.rationalCurveRegularSampleRange(e,e.knots[0],L.last(e.knots),t,n)},be.rationalCurveRegularSampleRange=function(e,t,n,r,i){r<1&&(r=2);for(var o=[],s=(n-t)/(r-1),a=0,u=0,l=r;u<l;){a=t+s*u++;i?o.push([a].concat(fe.rationalCurvePoint(e,a))):o.push(fe.rationalCurvePoint(e,a))}return o},be.rationalCurveAdaptiveSample=function(e,t,n){if(null==n&&(n=!1),null==t&&(t=1e-6),1!=e.degree)return be.rationalCurveAdaptiveSampleRange(e,e.knots[0],L.last(e.knots),t,n);if(n){for(var r=[],i=0,o=e.controlPoints.length;i<o;){s=i++;r.push([e.knots[s+1]].concat(fe.dehomogenize(e.controlPoints[s])))}return r}for(var s,a=e.controlPoints,u=fe.dehomogenize,l=new Array(a.length),r=0,i=a.length;r<i;)l[s=r++]=u(a[s]);return l},be.rationalCurveAdaptiveSampleRange=function(e,t,n,r,i){var o=fe.rationalCurvePoint(e,t),s=fe.rationalCurvePoint(e,n),a=t+(n-t)*(.5+.2*Math.random()),u=fe.rationalCurvePoint(e,a),l=pe.sub(o,s),a=pe.sub(o,u);if(pe.dot(l,l)<r&&pe.dot(a,a)>r||!se.threePointsAreFlat(o,u,s,r)){a=t+.5*(n-t),u=be.rationalCurveAdaptiveSampleRange(e,t,a,r,i),r=be.rationalCurveAdaptiveSampleRange(e,a,n,r,i);return u.slice(0,-1).concat(r)}return i?[[t].concat(o),[n].concat(s)]:[o,s]},be.rationalSurfaceNaive=function(e,t,n){t<1&&(t=1),n<1&&(n=1);e.degreeU,e.degreeV,e.controlPoints;for(var r=e.knotsU,i=e.knotsV,o=(L.last(r)-r[0])/t,s=(L.last(i)-i[0])/n,a=[],u=[],l=[],h=0,c=t+1;h<c;)for(var f=h++,v=0,_=n+1;v<_;){var d=f*o,g=(m=v++)*s;u.push([d,g]);d=fe.rationalSurfaceDerivatives(e,d,g,1),g=d[0][0];a.push(g);d=pe.normalized(pe.cross(d[1][0],d[0][1]));l.push(d)}for(var p=[],h=0,c=t;h<c;)for(f=h++,v=0,_=n;v<_;){var m,b=f*(n+1)+(m=v++),w=(f+1)*(n+1)+m,S=w+1,w=[b,w,S],b=[b,S,b+1];p.push(w),p.push(b)}return new y(p,a,l,u)},be.divideRationalSurfaceAdaptive=function(e,t){null==t&&(t=new we),t.minDivsU=null!=t.minDivsU?t.minDivsU:1,t.minDivsU=null!=t.minDivsV?t.minDivsV:1,t.refine=null==t.refine||t.refine;for(var n=2*(e.controlPoints.length-1),r=2*(e.controlPoints[0].length-1),i=t.minDivsU=t.minDivsU>n?t.minDivsU:n,o=t.minDivsV=t.minDivsV>r?t.minDivsV:r,n=L.last(e.knotsU),s=e.knotsU[0],r=L.last(e.knotsV),a=e.knotsV[0],u=(n-s)/i,l=(r-a)/o,h=[],c=[],f=0,v=o+1;f<v;){for(var _=f++,d=[],g=0,p=i+1;g<p;){var m=s+u*(y=g++),b=a+l*_,w=fe.rationalSurfaceDerivatives(e,m,b,1),S=pe.normalized(pe.cross(w[0][1],w[1][0]));d.push(new q(w[0][0],S,[m,b],-1,pe.isZero(S)))}c.push(d)}for(f=0,v=o;f<v;)for(_=f++,g=0,p=i;g<p;){var y=g++,P=[c[o-_-1][y],c[o-_-1][y+1],c[o-_][y+1],c[o-_][y]];h.push(new Se(e,P))}if(!t.refine)return h;for(f=0,v=o;f<v;)for(_=f++,g=0,p=i;g<p;){var k=_*i+(y=g++),C=be.north(k,_,y,i,o,h),x=be.east(k,_,y,i,o,h),M=be.south(k,_,y,i,o,h),z=be.west(k,_,y,i,o,h);h[k].neighbors=[M,x,C,z],h[k].divide(t)}return h},be.north=function(e,t,n,r,i,o){return 0==t?null:o[e-r]},be.south=function(e,t,n,r,i,o){return t==i-1?null:o[e+r]},be.east=function(e,t,n,r,i,o){return n==r-1?null:o[e+1]},be.west=function(e,t,n,r,i,o){return 0==n?null:o[e-1]},be.triangulateAdaptiveRefinementNodeTree=function(e){for(var t=y.empty(),n=0;n<e.length;){var r=e[n];++n,r.triangulate(t)}return t},be.rationalSurfaceAdaptive=function(e,t){null==t&&(t=new we);t=be.divideRationalSurfaceAdaptive(e,t);return be.triangulateAdaptiveRefinementNodeTree(t)};var we=e.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025};(n["verb.eval.AdaptiveRefinementOptions"]=we).__name__="verb.eval.AdaptiveRefinementOptions",we.prototype={__class__:we};var Se=e.core.AdaptiveRefinementNode=function(e,t,n){var r;this.srf=e,this.neighbors=null==n?[null,null,null,null]:n,this.corners=t,null==this.corners&&(r=e.knotsU[0],n=L.last(e.knotsU),t=e.knotsV[0],e=L.last(e.knotsV),this.corners=[q.fromUv(r,t),q.fromUv(n,t),q.fromUv(n,e),q.fromUv(r,e)])};(n["verb.eval.AdaptiveRefinementNode"]=Se).__name__="verb.eval.AdaptiveRefinementNode",Se.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){var e;this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2,null==this.corners[0].point&&(e=this.corners[0],this.evalSrf(e.uv[0],e.uv[1],e)),null==this.corners[1].point&&(e=this.corners[1],this.evalSrf(e.uv[0],e.uv[1],e)),null==this.corners[2].point&&(e=this.corners[2],this.evalSrf(e.uv[0],e.uv[1],e)),null==this.corners[3].point&&(e=this.corners[3],this.evalSrf(e.uv[0],e.uv[1],e))},evalSrf:function(e,t,n){var r=fe.rationalSurfaceDerivatives(this.srf,e,t,1),i=r[0][0],o=pe.cross(r[0][1],r[1][0]),r=pe.isZero(o);return r||(o=pe.normalized(o)),null!=n?(n.degen=r,n.point=i,n.normal=o,n):new q(i,o,[e,t],-1,r)},getEdgeCorners:function(e){if(this.isLeaf())return[this.corners[e]];if(this.horizontal)switch(e){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(e){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(e){var t=[this.corners[e]];if(null==this.neighbors[e])return t;for(var n=this.neighbors[e].getEdgeCorners((e+2)%4),e=e%2,r=D.EPSILON,i=this,o=[function(e){return e.uv[0]>i.corners[0].uv[0]+r&&e.uv[0]<i.corners[2].uv[0]-r},function(e){return e.uv[1]>i.corners[0].uv[1]+r&&e.uv[1]<i.corners[2].uv[1]-r}][e],s=[],a=0,u=n;a<u.length;){var l=u[a];++a,o(l)&&s.push(l)}n=s;return n.reverse(),t.concat(n)},midpoint:function(e){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[e])return this.midPoints[e];switch(e){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[e]},hasBadNormals:function(){return!!(this.corners[0].degen||this.corners[1].degen||this.corners[2].degen)||this.corners[3].degen},fixNormals:function(){for(var e=this.corners.length,t=0,n=e;t<n;){var r,i,o=t++;this.corners[o];this.corners[o].degen&&(r=this.corners[(1+o)%e],i=this.corners[(3+o)%e],this.corners[o].normal=(r.degen?i:r).normal)}},shouldDivide:function(e,t){if(t<e.minDepth)return!0;if(t>=e.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=pe.normSquared(pe.sub(this.corners[0].normal,this.corners[1].normal))>e.normTol||pe.normSquared(pe.sub(this.corners[2].normal,this.corners[3].normal))>e.normTol,this.splitHoriz=pe.normSquared(pe.sub(this.corners[1].normal,this.corners[2].normal))>e.normTol||pe.normSquared(pe.sub(this.corners[3].normal,this.corners[0].normal))>e.normTol,this.splitVert||this.splitHoriz)return!0;t=this.center();return pe.normSquared(pe.sub(t.normal,this.corners[0].normal))>e.normTol||pe.normSquared(pe.sub(t.normal,this.corners[1].normal))>e.normTol||pe.normSquared(pe.sub(t.normal,this.corners[2].normal))>e.normTol||pe.normSquared(pe.sub(t.normal,this.corners[3].normal))>e.normTol},divide:function(e){null==e&&(e=new we),null==e.normTol&&(e.normTol=.085),null==e.minDepth&&(e.minDepth=0),null==e.maxDepth&&(e.maxDepth=10),this._divide(e,0,!0)},_divide:function(e,t,n){if(this.evalCorners(),this.shouldDivide(e,t)){var r,i;++t,this.splitVert&&!this.splitHoriz?n=!1:!this.splitVert&&this.splitHoriz&&(n=!0),this.horizontal=n,this.horizontal?(r=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],i=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]],this.children=[new Se(this.srf,r),new Se(this.srf,i)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]):(r=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],i=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)],this.children=[new Se(this.srf,r),new Se(this.srf,i)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]);for(var o=0,s=this.children;o<s.length;){var a=s[o];++o,a._divide(e,t,!n)}}},triangulate:function(e){if(null==e&&(e=y.empty()),this.isLeaf())return this.triangulateLeaf(e);for(var t=0,n=this.children;t<n.length;){var r=n[t];if(++t,null==r)break;r.triangulate(e)}return e},triangulateLeaf:function(e){var t=e.points.length,n=[],r=[],i=0,o=this.getAllCorners(0);2==o.length&&(i=1);for(var s=0,a=o.length;s<a;){var u=s++;n.push(o[u])}2==(o=this.getAllCorners(1)).length&&(i=2);for(s=0,a=o.length;s<a;){u=s++;n.push(o[u])}2==(o=this.getAllCorners(2)).length&&(i=3);for(s=0,a=o.length;s<a;){u=s++;n.push(o[u])}2==(o=this.getAllCorners(3)).length&&(i=4);for(s=0,a=o.length;s<a;){u=s++;n.push(o[u])}for(s=0;s<n.length;){var l=n[s];++s,-1==l.id?(e.uvs.push(l.uv),e.points.push(l.point),e.normals.push(l.normal),l.id=t,r.push(t),++t):r.push(l.id)}if(4==n.length)return e.faces.push([r[0],r[3],r[1]]),e.faces.push([r[3],r[2],r[1]]),e;if(5==n.length){var h=r.length;return e.faces.push([r[i],r[(i+2)%h],r[(i+1)%h]]),e.faces.push([r[(i+4)%h],r[(i+3)%h],r[i]]),e.faces.push([r[i],r[(i+3)%h],r[(i+2)%h]]),e}h=this.center();e.uvs.push(h.uv),e.points.push(h.point),e.normals.push(h.normal);for(var c=e.points.length-1,f=0,u=n.length-1;f<n.length;)e.faces.push([c,r[f],r[u]]),u=++f-1;return e},__class__:Se},d=function(){},(n["verb.geom.ICurve"]=d).__name__="verb.geom.ICurve",d.__isInterface__=!0,d.__interfaces__=[a],d.prototype={__class__:d};var ye=e.geom.NurbsCurve=function(e){this._data=le.isValidNurbsCurveData(e)};(n["verb.geom.NurbsCurve"]=ye).__name__="verb.geom.NurbsCurve",ye.__interfaces__=[d],ye.byKnotsControlPointsWeights=function(e,t,n,r){return new ye(new ge(e,t.slice(),fe.homogenize1d(n,r)))},ye.byPoints=function(e,t){return null==t&&(t=3),new ye(_e.rationalInterpCurve(e,t))},ye.__super__=_,ye.prototype=i(_.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return fe.dehomogenize1d(this._data.controlPoints)},weights:function(){return fe.weight1d(this._data.controlPoints)},asNurbs:function(){return new ge(this.degree(),this.knots(),fe.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new ye(this._data)},domain:function(){return new S(L.first(this._data.knots),L.last(this._data.knots))},transform:function(e){return new ye(me.rationalCurveTransform(this._data,e))},point:function(e){return fe.rationalCurvePoint(this._data,e)},tangent:function(e){return fe.rationalCurveTangent(this._data,e)},derivatives:function(e,t){return null==t&&(t=1),fe.rationalCurveDerivatives(this._data,e,t)},closestPoint:function(e){return ae.rationalCurveClosestPoint(this._data,e)},closestParam:function(e){return ae.rationalCurveClosestParam(this._data,e)},length:function(){return ae.rationalCurveArcLength(this._data)},lengthAtParam:function(e){return ae.rationalCurveArcLength(this._data,e)},paramAtLength:function(e,t){return ae.rationalCurveParamAtArcLength(this._data,e,t)},divideByEqualArcLength:function(e){return he.rationalCurveByEqualArcLength(this._data,e)},divideByArcLength:function(e){return he.rationalCurveByArcLength(this._data,e)},split:function(e){for(var t=he.curveSplit(this._data,e),n=new Array(t.length),r=0,i=t.length;r<i;){var o=r++;n[o]=new ye(t[o])}return n},reverse:function(){return new ye(me.curveReverse(this._data))},tessellate:function(e){return be.rationalCurveAdaptiveSample(this._data,e,!1)},__class__:ye});var Pe=e.geom.Arc=function(e,t,n,r,i,o){ye.call(this,_e.arc(e,t,n,r,i,o)),this._center=e,this._xaxis=t,this._yaxis=n,this._radius=r,this._minAngle=i,this._maxAngle=o};(n["verb.geom.Arc"]=Pe).__name__="verb.geom.Arc",Pe.__super__=ye,Pe.prototype=i(ye.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Pe}),d=e.geom.BezierCurve=function(e,t){ye.call(this,_e.rationalBezierCurve(e,t))},(n["verb.geom.BezierCurve"]=d).__name__="verb.geom.BezierCurve",d.__super__=ye,d.prototype=i(ye.prototype,{__class__:d}),d=e.geom.Circle=function(e,t,n,r){Pe.call(this,e,t,n,r,0,2*Math.PI)},(n["verb.geom.Circle"]=d).__name__="verb.geom.Circle",d.__super__=Pe,d.prototype=i(Pe.prototype,{__class__:d}),d=function(){},(n["verb.geom.ISurface"]=d).__name__="verb.geom.ISurface",d.__isInterface__=!0,d.__interfaces__=[a],d.prototype={__class__:d};var ke=e.geom.NurbsSurface=function(e){this._data=le.isValidNurbsSurfaceData(e)};(n["verb.geom.NurbsSurface"]=ke).__name__="verb.geom.NurbsSurface",ke.__interfaces__=[d],ke.byKnotsControlPointsWeights=function(e,t,n,r,i,o){return new ke(new O(e,t,n,r,fe.homogenize2d(i,o)))},ke.byCorners=function(e,t,n,r){return new ke(_e.fourPointSurface(e,t,n,r))},ke.byLoftingCurves=function(e,t){for(var n=[],r=0;r<e.length;){var i=e[r];++r,n.push(i.asNurbs())}return new ke(_e.loftedSurface(n,t))},ke.__super__=_,ke.prototype=i(_.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return fe.dehomogenize2d(this._data.controlPoints)},weights:function(){return fe.weight2d(this._data.controlPoints)},asNurbs:function(){return new O(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),fe.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new ke(this.asNurbs())},domainU:function(){return new S(L.first(this._data.knotsU),L.last(this._data.knotsU))},domainV:function(){return new S(L.first(this._data.knotsV),L.last(this._data.knotsV))},point:function(e,t){return fe.rationalSurfacePoint(this._data,e,t)},normal:function(e,t){return fe.rationalSurfaceNormal(this._data,e,t)},derivatives:function(e,t,n){return null==n&&(n=1),fe.rationalSurfaceDerivatives(this._data,e,t,n)},closestParam:function(e){return ae.rationalSurfaceClosestParam(this._data,e)},closestPoint:function(e){return ae.rationalSurfaceClosestPoint(this._data,e)},split:function(e,t){null==t&&(t=!1);for(var n=he.surfaceSplit(this._data,e,t),r=new Array(n.length),i=0,o=n.length;i<o;){var s=i++;r[s]=new ke(n[s])}return r},reverse:function(e){return null==e&&(e=!1),new ke(me.surfaceReverse(this._data,e))},isocurve:function(e,t){return null==t&&(t=!1),new ye(_e.surfaceIsocurve(this._data,e,t))},boundaries:function(e){for(var t=_e.surfaceBoundaryCurves(this._data),n=new Array(t.length),r=0,i=t.length;r<i;){var o=r++;n[o]=new ye(t[o])}return n},tessellate:function(e){return be.rationalSurfaceAdaptive(this._data,e)},transform:function(e){return new ke(me.rationalSurfaceTransform(this._data,e))},__class__:ke}),_=e.geom.ConicalSurface=function(e,t,n,r,i){ke.call(this,_e.conicalSurface(e,t,n,r,i)),this._axis=e,this._xaxis=t,this._base=n,this._height=r,this._radius=i},(n["verb.geom.ConicalSurface"]=_).__name__="verb.geom.ConicalSurface",_.__super__=ke,_.prototype=i(ke.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:_}),_=e.geom.CylindricalSurface=function(e,t,n,r,i){ke.call(this,_e.cylindricalSurface(e,t,n,r,i)),this._axis=e,this._xaxis=t,this._base=n,this._height=r,this._radius=i},(n["verb.geom.CylindricalSurface"]=_).__name__="verb.geom.CylindricalSurface",_.__super__=ke,_.prototype=i(ke.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:_});var Ce=e.geom.EllipseArc=function(e,t,n,r,i){ye.call(this,_e.ellipseArc(e,t,n,r,i)),this._center=e,this._xaxis=t,this._yaxis=n,this._minAngle=r,this._maxAngle=i};function xe(e){return e instanceof Array?new c(e):e.iterator()}(n["verb.geom.EllipseArc"]=Ce).__name__="verb.geom.EllipseArc",Ce.__super__=ye,Ce.prototype=i(ye.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Ce}),_=e.geom.Ellipse=function(e,t,n){Ce.call(this,e,t,n,0,2*Math.PI)},(n["verb.geom.Ellipse"]=_).__name__="verb.geom.Ellipse",_.__super__=Ce,_.prototype=i(Ce.prototype,{__class__:_}),_=e.geom.ExtrudedSurface=function(e,t){ke.call(this,_e.extrudedSurface(pe.normalized(t),pe.norm(t),e.asNurbs())),this._profile=e,this._direction=t},(n["verb.geom.ExtrudedSurface"]=_).__name__="verb.geom.ExtrudedSurface",_.__super__=ke,_.prototype=i(ke.prototype,{profile:function(){return this._profile},direction:function(){return this._direction},__class__:_}),_=e.geom.Intersect=function(){},(n["verb.geom.Intersect"]=_).__name__="verb.geom.Intersect",_.curves=function(e,t,n){return null==n&&(n=.001),ve.curves(e.asNurbs(),t.asNurbs(),n)},_.curveAndSurface=function(e,t,n){return null==n&&(n=.001),ve.curveAndSurface(e.asNurbs(),t.asNurbs(),n)},_.surfaces=function(e,t,n){null==n&&(n=.001);for(var r=ve.surfaces(e.asNurbs(),t.asNurbs(),n),i=new Array(r.length),o=0,s=r.length;o<s;){var a=o++;i[a]=new ye(r[a])}return i},_=e.geom.Line=function(e,t){ye.call(this,_e.polyline([e,t])),this._start=e,this._end=t},(n["verb.geom.Line"]=_).__name__="verb.geom.Line",_.__super__=ye,_.prototype=i(ye.prototype,{start:function(){return this._start},end:function(){return this._end},__class__:_}),_=e.geom.RevolvedSurface=function(e,t,n,r){ke.call(this,_e.revolvedSurface(e.asNurbs(),t,n,r)),this._profile=e,this._center=t,this._axis=n,this._angle=r},(n["verb.geom.RevolvedSurface"]=_).__name__="verb.geom.RevolvedSurface",_.__super__=ke,_.prototype=i(ke.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle},__class__:_}),_=e.geom.SphericalSurface=function(e,t){ke.call(this,_e.sphericalSurface(e,[0,0,1],[1,0,0],t)),this._center=e,this._radius=t},(n["verb.geom.SphericalSurface"]=_).__name__="verb.geom.SphericalSurface",_.__super__=ke,_.prototype=i(ke.prototype,{center:function(){return this._center},radius:function(){return this._radius},__class__:_}),_=e.geom.SweptSurface=function(e,t){ke.call(this,_e.rationalTranslationalSurface(e.asNurbs(),t.asNurbs())),this._profile=e,this._rail=t},(n["verb.geom.SweptSurface"]=_).__name__="verb.geom.SweptSurface",_.__super__=ke,_.prototype=i(ke.prototype,{profile:function(){return this._profile},rail:function(){return this._rail},__class__:_}),r.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(C.now=performance.now.bind(performance)),n.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),String.prototype.__class__=n.String=String,String.__name__="String",n.Array=Array,Array.__name__="Array",Date.prototype.__class__=n.Date=Date,Date.__name__="Date";var Me={},ze={},Ae=Number,Ie=Boolean,Ne={},Ee={};E.count=0,B.__toStr={}.toString,z.USE_CACHE=!1,z.USE_ENUM_INDEX=!1,z.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",A.DEFAULT_RESOLVER=new u,A.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",de.memo=new I,e.TOLERANCE=D.TOLERANCE=1e-6,e.EPSILON=D.EPSILON=1e-10,e.VERSION=D.VERSION="2.0.0",ae.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],ae.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],f.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this),{}});